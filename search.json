[{"path":[]},{"path":"https://phipsonlab.github.io/SuperCellCyto/CODE_OF_CONDUCT.html","id":"our-pledge","dir":"","previous_headings":"","what":"Our Pledge","title":"Contributor Covenant Code of Conduct","text":"members, contributors, leaders pledge make participation community harassment-free experience everyone, regardless age, body size, visible invisible disability, ethnicity, sex characteristics, gender identity expression, level experience, education, socio-economic status, nationality, personal appearance, race, caste, color, religion, sexual identity orientation. pledge act interact ways contribute open, welcoming, diverse, inclusive, healthy community.","code":""},{"path":"https://phipsonlab.github.io/SuperCellCyto/CODE_OF_CONDUCT.html","id":"our-standards","dir":"","previous_headings":"","what":"Our Standards","title":"Contributor Covenant Code of Conduct","text":"Examples behavior contributes positive environment community include: Demonstrating empathy kindness toward people respectful differing opinions, viewpoints, experiences Giving gracefully accepting constructive feedback Accepting responsibility apologizing affected mistakes, learning experience Focusing best just us individuals, overall community Examples unacceptable behavior include: use sexualized language imagery, sexual attention advances kind Trolling, insulting derogatory comments, personal political attacks Public private harassment Publishing others’ private information, physical email address, without explicit permission conduct reasonably considered inappropriate professional setting","code":""},{"path":"https://phipsonlab.github.io/SuperCellCyto/CODE_OF_CONDUCT.html","id":"enforcement-responsibilities","dir":"","previous_headings":"","what":"Enforcement Responsibilities","title":"Contributor Covenant Code of Conduct","text":"Community leaders responsible clarifying enforcing standards acceptable behavior take appropriate fair corrective action response behavior deem inappropriate, threatening, offensive, harmful. Community leaders right responsibility remove, edit, reject comments, commits, code, wiki edits, issues, contributions aligned Code Conduct, communicate reasons moderation decisions appropriate.","code":""},{"path":"https://phipsonlab.github.io/SuperCellCyto/CODE_OF_CONDUCT.html","id":"scope","dir":"","previous_headings":"","what":"Scope","title":"Contributor Covenant Code of Conduct","text":"Code Conduct applies within community spaces, also applies individual officially representing community public spaces. Examples representing community include using official e-mail address, posting via official social media account, acting appointed representative online offline event.","code":""},{"path":"https://phipsonlab.github.io/SuperCellCyto/CODE_OF_CONDUCT.html","id":"enforcement","dir":"","previous_headings":"","what":"Enforcement","title":"Contributor Covenant Code of Conduct","text":"Instances abusive, harassing, otherwise unacceptable behavior may reported community leaders responsible enforcement putri.g@wehi.edu.au. complaints reviewed investigated promptly fairly. community leaders obligated respect privacy security reporter incident.","code":""},{"path":"https://phipsonlab.github.io/SuperCellCyto/CODE_OF_CONDUCT.html","id":"enforcement-guidelines","dir":"","previous_headings":"","what":"Enforcement Guidelines","title":"Contributor Covenant Code of Conduct","text":"Community leaders follow Community Impact Guidelines determining consequences action deem violation Code Conduct:","code":""},{"path":"https://phipsonlab.github.io/SuperCellCyto/CODE_OF_CONDUCT.html","id":"id_1-correction","dir":"","previous_headings":"Enforcement Guidelines","what":"1. Correction","title":"Contributor Covenant Code of Conduct","text":"Community Impact: Use inappropriate language behavior deemed unprofessional unwelcome community. Consequence: private, written warning community leaders, providing clarity around nature violation explanation behavior inappropriate. public apology may requested.","code":""},{"path":"https://phipsonlab.github.io/SuperCellCyto/CODE_OF_CONDUCT.html","id":"id_2-warning","dir":"","previous_headings":"Enforcement Guidelines","what":"2. Warning","title":"Contributor Covenant Code of Conduct","text":"Community Impact: violation single incident series actions. Consequence: warning consequences continued behavior. interaction people involved, including unsolicited interaction enforcing Code Conduct, specified period time. includes avoiding interactions community spaces well external channels like social media. Violating terms may lead temporary permanent ban.","code":""},{"path":"https://phipsonlab.github.io/SuperCellCyto/CODE_OF_CONDUCT.html","id":"id_3-temporary-ban","dir":"","previous_headings":"Enforcement Guidelines","what":"3. Temporary Ban","title":"Contributor Covenant Code of Conduct","text":"Community Impact: serious violation community standards, including sustained inappropriate behavior. Consequence: temporary ban sort interaction public communication community specified period time. public private interaction people involved, including unsolicited interaction enforcing Code Conduct, allowed period. Violating terms may lead permanent ban.","code":""},{"path":"https://phipsonlab.github.io/SuperCellCyto/CODE_OF_CONDUCT.html","id":"id_4-permanent-ban","dir":"","previous_headings":"Enforcement Guidelines","what":"4. Permanent Ban","title":"Contributor Covenant Code of Conduct","text":"Community Impact: Demonstrating pattern violation community standards, including sustained inappropriate behavior, harassment individual, aggression toward disparagement classes individuals. Consequence: permanent ban sort public interaction within community.","code":""},{"path":"https://phipsonlab.github.io/SuperCellCyto/CODE_OF_CONDUCT.html","id":"attribution","dir":"","previous_headings":"","what":"Attribution","title":"Contributor Covenant Code of Conduct","text":"Code Conduct adapted Contributor Covenant, version 2.1, available https://www.contributor-covenant.org/version/2/1/code_of_conduct.html. Community Impact Guidelines inspired [Mozilla’s code conduct enforcement ladder][https://github.com/mozilla/inclusion]. answers common questions code conduct, see FAQ https://www.contributor-covenant.org/faq. Translations available https://www.contributor-covenant.org/translations.","code":""},{"path":"https://phipsonlab.github.io/SuperCellCyto/CONTRIBUTING.html","id":null,"dir":"","previous_headings":"","what":"Contributing to SuperCellCyto","title":"Contributing to SuperCellCyto","text":"outlines propose change SuperCellCyto.","code":""},{"path":"https://phipsonlab.github.io/SuperCellCyto/CONTRIBUTING.html","id":"making-changes-to-the-package","dir":"","previous_headings":"","what":"Making changes to the package","title":"Contributing to SuperCellCyto","text":"want make change, please first file issue make sure someone team agrees ’s needed. ’ve found bug, please file issue illustrates bug minimal reprex (also help write unit test, needed).","code":""},{"path":"https://phipsonlab.github.io/SuperCellCyto/CONTRIBUTING.html","id":"pull-request-process","dir":"","previous_headings":"Making changes to the package","what":"Pull request process","title":"Contributing to SuperCellCyto","text":"Fork package clone onto computer. Install development dependencies devtools::install_dev_deps(). Create Git branch pull request (PR). can use usethis::pr_init(\"brief-description--change\"). Make changes, commit git. Make sure unit tests passing. can use devtools::test(). Create PR. Make sure title PR briefly describe change, body PR contain Fixes #issue-number.","code":""},{"path":"https://phipsonlab.github.io/SuperCellCyto/CONTRIBUTING.html","id":"code-of-conduct","dir":"","previous_headings":"","what":"Code of Conduct","title":"Contributing to SuperCellCyto","text":"Please note SuperCellCyto project released Contributor Code Conduct. contributing project agree abide terms.","code":""},{"path":"https://phipsonlab.github.io/SuperCellCyto/articles/how_to_create_supercells.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"How to create supercells","text":"vignette describes steps generate supercells cytometry data using SuperCellCyto R package.","code":""},{"path":"https://phipsonlab.github.io/SuperCellCyto/articles/how_to_create_supercells.html","id":"preparing-your-dataset","dir":"Articles","previous_headings":"","what":"Preparing your dataset","title":"How to create supercells","text":"function creates supercells called runSuperCellCyto, operates data.table object, enhanced version R native data.frame. addition needing data stored data.table object also requires: markers using create supercells appropriately transformed, typically using either arcsinh transformation linear binning (using FlowJo). runSuperCellCyto perform data transformation scaling. object column denoting unique ID cell. likely create column , can simply just numerical value ranging 1 however many cells data. object column denoting biological sample cell comes . column critical ensure cells different samples mixed supercell. sure import CSV FCS files data.table object, /subsequently prepare object ready SuperCellCyto, please consult vignette. vignette, also provide explanation behind need cell ID sample column. vignette, simulate toy data using simCytoData function. Specifically, simulate 15 markers 3 samples, sample containing 10,000 cells. Hence total, toy dataset containing 15 markers 30,000 cells. toy dataset, transform data using arcsinh transformation. use base R asinh function : also create column Cell_id_dummy uniquely identify cell. values Cell_1, Cell_2, way Cell_x x number cells dataset. default, simCytoData function generate cells multiple samples, resulting data.table object already column called Sample denotes sample cells come . Let’s take note sample cell id column later.","code":"n_markers <- 15 n_samples <- 3 dat <- simCytoData(nmarkers = n_markers, ncells = rep(10000, n_samples)) head(dat) #>    Marker_1 Marker_2 Marker_3 Marker_4 Marker_5 Marker_6 Marker_7  Marker_8 #>       <num>    <num>    <num>    <num>    <num>    <num>    <num>     <num> #> 1: 5.354062 18.00190 15.34377 7.850049 5.051249 12.76034 13.45909  9.120952 #> 2: 4.686508 17.25606 13.81100 7.734731 4.959933 12.52533 13.06860 10.242089 #> 3: 8.180677 17.65222 12.35144 8.879722 5.397469 10.84124 10.66265 11.661453 #> 4: 6.674427 17.65331 13.36466 7.837501 6.737175 13.58634 11.60650  8.275668 #> 5: 5.355100 17.10721 13.62514 8.168731 4.915897 11.64593 12.26424  9.469937 #> 6: 6.859295 17.74649 13.33065 7.507828 5.841775 11.42130 12.11751  9.552281 #>    Marker_9 Marker_10 Marker_11 Marker_12 Marker_13 Marker_14 Marker_15 #>       <num>     <num>     <num>     <num>     <num>     <num>     <num> #> 1: 15.28438  17.76261  18.55511  6.792268  4.139855  9.517666 11.550815 #> 2: 16.19940  14.33739  17.25021  5.879038  5.566083 10.853051  9.799421 #> 3: 14.97142  16.23926  18.64175  7.594556  6.941313 11.113545 11.836116 #> 4: 13.83856  14.75398  18.88236  6.135554  6.368055  9.458724 12.558570 #> 5: 15.99549  15.71650  19.60589  6.845101  6.096939  9.749784  9.679683 #> 6: 15.44915  16.85604  18.80598  8.261104  5.114830  9.633085 10.437587 #>      Sample Cell_Id #>      <char>  <char> #> 1: Sample_1  Cell_1 #> 2: Sample_1  Cell_2 #> 3: Sample_1  Cell_3 #> 4: Sample_1  Cell_4 #> 5: Sample_1  Cell_5 #> 6: Sample_1  Cell_6 # Specify which columns are the markers to transform marker_cols <- paste0(\"Marker_\", seq_len(n_markers)) # The co-factor for arc-sinh cofactor <- 5  # Do the transformation dat_asinh <- asinh(dat[, marker_cols, with = FALSE] / cofactor)  # Rename the new columns marker_cols_asinh <- paste0(marker_cols, \"_asinh\") names(dat_asinh) <- marker_cols_asinh  # Add them our previously loaded data dat <- cbind(dat, dat_asinh)  head(dat[, marker_cols_asinh, with = FALSE]) #>    Marker_1_asinh Marker_2_asinh Marker_3_asinh Marker_4_asinh Marker_5_asinh #>             <num>          <num>          <num>          <num>          <num> #> 1:      0.9305698       1.992938       1.839967       1.232981      0.8886028 #> 2:      0.8363371       1.952231       1.740438       1.220525      0.8756959 #> 3:      1.2679809       1.974051       1.636139       1.338698      0.9364823 #> 4:      1.0995432       1.974110       1.709609       1.231632      1.1070448 #> 5:      0.9307114       1.943912       1.727709       1.266734      0.8694294 #> 6:      1.1215159       1.979176       1.707223       1.195631      0.9955558 #>    Marker_6_asinh Marker_7_asinh Marker_8_asinh Marker_9_asinh Marker_10_asinh #>             <num>          <num>          <num>          <num>           <num> #> 1:       1.666397       1.716206       1.362129       1.836280        1.980050 #> 2:       1.649111       1.688657       1.465081       1.891692        1.775685 #> 3:       1.516443       1.501381       1.583078       1.816637        1.894041 #> 4:       1.725033       1.578739       1.277847       1.742313        1.802771 #> 5:       1.581854       1.629576       1.395195       1.879595        1.862814 #> 6:       1.563985       1.618440       1.402858       1.846477        1.929723 #>    Marker_11_asinh Marker_12_asinh Marker_13_asinh Marker_14_asinh #>              <num>           <num>           <num>           <num> #> 1:        2.022133        1.113594       0.7543612        1.399643 #> 2:        1.951905        1.000393       0.9592082        1.517431 #> 3:        2.026631        1.205208       1.1311408        1.539018 #> 4:        2.039023        1.033214       1.0622582        1.394147 #> 5:        2.075416        1.119843       1.0283259        1.421029 #> 6:        2.035105        1.276340       0.8975202        1.410328 #>    Marker_15_asinh #>              <num> #> 1:        1.574323 #> 2:        1.425550 #> 3:        1.596758 #> 4:        1.651573 #> 5:        1.414613 #> 6:        1.482103 dat$Cell_id_dummy <- paste0(\"Cell_\", seq_len(nrow(dat))) head(dat$Cell_id_dummy, n = 10) #>  [1] \"Cell_1\"  \"Cell_2\"  \"Cell_3\"  \"Cell_4\"  \"Cell_5\"  \"Cell_6\"  \"Cell_7\"  #>  [8] \"Cell_8\"  \"Cell_9\"  \"Cell_10\" unique(dat$Sample) #> [1] \"Sample_1\" \"Sample_2\" \"Sample_3\" sample_col <- \"Sample\" cell_id_col <- \"Cell_id_dummy\""},{"path":"https://phipsonlab.github.io/SuperCellCyto/articles/how_to_create_supercells.html","id":"creating-supercells","dir":"Articles","previous_headings":"","what":"Creating supercells","title":"How to create supercells","text":"Now data, let’s create supercells. , use runSuperCellCyto function pass markers, sample cell ID columns parameters. reason need specify markers function create supercells based expression markers. highly recommend creating supercells using markers data, let cell type cell state markers. However, reason want use subset markers data, make sure specify vector later pass runSuperCellCyto function. tutorial, use arcsinh transformed markers toy data. Let’s dig deeper object created: list containing 3 elements:","code":"supercells <- runSuperCellCyto(     dt = dat,     markers = marker_cols_asinh,     sample_colname = sample_col,     cell_id_colname = cell_id_col ) class(supercells) #> [1] \"list\" names(supercells) #> [1] \"supercell_expression_matrix\" \"supercell_cell_map\"          #> [3] \"supercell_object\""},{"path":"https://phipsonlab.github.io/SuperCellCyto/articles/how_to_create_supercells.html","id":"supercell-object","dir":"Articles","previous_headings":"Creating supercells","what":"Supercell object","title":"How to create supercells","text":"supercell_object contains metadata used create supercells. list, element contains metadata used create supercells sample. come handy need either regenerate supercells using different gamma values (get less supercells) debugging later line. regenerating supercells Controlling supercells granularity section .","code":""},{"path":"https://phipsonlab.github.io/SuperCellCyto/articles/how_to_create_supercells.html","id":"supercell-expression-matrix","dir":"Articles","previous_headings":"Creating supercells","what":"Supercell expression matrix","title":"How to create supercells","text":"supercell_expression_matrix contains marker expression supercell. calculated taking average marker expression cells contained within supercell. Therein, following columns: markers previously specified markers_col variable. example, arcsinh transformed markers toy data. column (Sample case) denoting sample supercell belongs , (note column name stored sample_col variable). SuperCellId column denoting unique ID supercell.","code":"head(supercells$supercell_expression_matrix) #>    Marker_1_asinh Marker_2_asinh Marker_3_asinh Marker_4_asinh Marker_5_asinh #>             <num>          <num>          <num>          <num>          <num> #> 1:      1.0980359       1.976635       1.744046       1.284006      0.8406754 #> 2:      1.2708808       1.959270       1.768194       1.213510      0.8435833 #> 3:      0.9358373       1.967619       1.753471       1.061320      0.9084702 #> 4:      0.9918583       1.970370       1.759316       1.039592      0.9232826 #> 5:      1.0859961       1.959836       1.772245       1.180816      0.8296192 #> 6:      0.9839823       1.987265       1.776855       1.142725      0.9624379 #>    Marker_6_asinh Marker_7_asinh Marker_8_asinh Marker_9_asinh Marker_10_asinh #>             <num>          <num>          <num>          <num>           <num> #> 1:       1.592370       1.633241       1.465175       1.895975        1.913915 #> 2:       1.661065       1.656824       1.310378       1.880409        1.944117 #> 3:       1.669144       1.578482       1.503876       1.887718        1.937788 #> 4:       1.610901       1.649418       1.356484       1.863929        1.918834 #> 5:       1.656676       1.664531       1.367829       1.868905        1.916273 #> 6:       1.551666       1.745967       1.412334       1.879636        1.940357 #>    Marker_11_asinh Marker_12_asinh Marker_13_asinh Marker_14_asinh #>              <num>           <num>           <num>           <num> #> 1:        1.994611        1.202137       0.7467371        1.355013 #> 2:        2.022654        1.213900       0.8402130        1.379115 #> 3:        2.010279        1.276539       0.8606365        1.423122 #> 4:        2.008280        1.023822       0.9759029        1.365365 #> 5:        1.993215        1.193693       0.6546532        1.412407 #> 6:        2.012757        1.160411       0.7766171        1.430625 #>    Marker_15_asinh   Sample                 SuperCellId #>              <num>   <char>                      <char> #> 1:        1.622478 Sample_1 SuperCell_1_Sample_Sample_1 #> 2:        1.510947 Sample_1 SuperCell_2_Sample_Sample_1 #> 3:        1.571943 Sample_1 SuperCell_3_Sample_Sample_1 #> 4:        1.547063 Sample_1 SuperCell_4_Sample_Sample_1 #> 5:        1.578565 Sample_1 SuperCell_5_Sample_Sample_1 #> 6:        1.460961 Sample_1 SuperCell_6_Sample_Sample_1"},{"path":"https://phipsonlab.github.io/SuperCellCyto/articles/how_to_create_supercells.html","id":"supercellid","dir":"Articles","previous_headings":"Creating supercells > Supercell expression matrix","what":"SuperCellId","title":"How to create supercells","text":"Let’s look SuperCellId: Let’s break one , SuperCell_1_Sample_Sample_1. SuperCell_1 numbering (1 however many supercells sample) used uniquely identify supercell sample. Notably, may encounter (SuperCell_1, SuperCell_2) repeated across different samples, e.g., 3 supercells’ id pre-fixed SuperCell_1, make equal one another! SuperCell_1_Sample_Sample_1 contain cells Sample_1 SuperCell_1_Sample_Sample_2 contain cells Sample_2. now, may noticed appended sample name supercell id. aids differentiating supercells different samples.","code":"head(unique(supercells$supercell_expression_matrix$SuperCellId)) #> [1] \"SuperCell_1_Sample_Sample_1\" \"SuperCell_2_Sample_Sample_1\" #> [3] \"SuperCell_3_Sample_Sample_1\" \"SuperCell_4_Sample_Sample_1\" #> [5] \"SuperCell_5_Sample_Sample_1\" \"SuperCell_6_Sample_Sample_1\" supercell_ids <- unique(supercells$supercell_expression_matrix$SuperCellId) supercell_ids[grep(\"SuperCell_1_\", supercell_ids)] #> [1] \"SuperCell_1_Sample_Sample_1\" \"SuperCell_1_Sample_Sample_2\" #> [3] \"SuperCell_1_Sample_Sample_3\""},{"path":"https://phipsonlab.github.io/SuperCellCyto/articles/how_to_create_supercells.html","id":"supercell-cell-map","dir":"Articles","previous_headings":"Creating supercells","what":"Supercell cell map","title":"How to create supercells","text":"supercell_cell_map maps cell dataset supercell belongs . map useful later need expand supercells . Additionally, also reason need column dataset uniquely identify cell.","code":"head(supercells$supercell_cell_map) #>                     SuperCellID CellId   Sample #>                          <char> <char>   <char> #> 1: SuperCell_13_Sample_Sample_1 Cell_1 Sample_1 #> 2: SuperCell_45_Sample_Sample_1 Cell_2 Sample_1 #> 3: SuperCell_32_Sample_Sample_1 Cell_3 Sample_1 #> 4: SuperCell_66_Sample_Sample_1 Cell_4 Sample_1 #> 5: SuperCell_64_Sample_Sample_1 Cell_5 Sample_1 #> 6: SuperCell_54_Sample_Sample_1 Cell_6 Sample_1"},{"path":"https://phipsonlab.github.io/SuperCellCyto/articles/how_to_create_supercells.html","id":"running-runsupercellcyto-in-parallel","dir":"Articles","previous_headings":"","what":"Running runSuperCellCyto in parallel","title":"How to create supercells","text":"default, runSuperCellCyto process sample one . sample processed independent one another, strictly speaking, can process parallel. , need : Create BiocParallelParam object BiocParallel package. object can either type MulticoreParamor SnowParam. highly recommend consulting vignette information. Set number tasks BiocParallelParam object number samples dataset. Set load_balancing parameter runSuperCellCyto function TRUE. ensure even distribution supercell creation jobs. sample processed parallel job, don’t want job processs large sample also assigned smaller samples possible. want know feature works, please refer manuscript.","code":"supercell_par <- runSuperCellCyto(     dt = dat,     markers = marker_cols_asinh,     sample_colname = sample_col,     cell_id_colname = cell_id_col,     BPPARAM = MulticoreParam(tasks = n_samples),     load_balancing = TRUE )"},{"path":"https://phipsonlab.github.io/SuperCellCyto/articles/how_to_create_supercells.html","id":"controlling-supercells-granularity","dir":"Articles","previous_headings":"","what":"Controlling supercells granularity","title":"How to create supercells","text":"described runSuperCellCyto function’s documentation, let’s briefly go . runSuperCellCyto function equipped various parameters can customised alter composition supercells. one likely used gamma parameter, denoted gam function. default, value gam set 20, found work well cases. gamma parameter controls many supercells generate, indirectly, many cells captured within supercell. parameter resolved following formula gamma=n_cells/n_supercells n_cell denotes number cells n_supercells denotes number supercells. general, larger gamma parameter set , less supercells get. Say instance 10,000 cells. gamma set 10, end 1,000 supercells, whereas gamma set 50, end 200 supercells. may noticed, reading sections , runSuperCellCyto ran sample independent , can set 1 value gamma parameter. Indeed, now, gamma value used across samples, depending many cells sample, end different number supercells sample. instance, say 10,000 cells sample 1, 100,000 cells sample 2. gamma set 10, sample 1, get 1,000 supercells (10,000/10) sample 2, get 10,000 supercells (100,000/10). note: whatever gamma value chose, expect supercell contain exactly number cells. behaviour intentional ensure rare cell types intermixed non-rare cell types supercell.","code":""},{"path":"https://phipsonlab.github.io/SuperCellCyto/articles/how_to_create_supercells.html","id":"adjusting-gamma-value-after-one-run-of-runsupercellcyto","dir":"Articles","previous_headings":"Controlling supercells granularity","what":"Adjusting gamma value after one run of runSuperCellCyto","title":"How to create supercells","text":"run runSuperCellCyto discarded SuperCell object generated (serious, please don’t!), can use object quickly regenerate supercells using different gamma values. example, using SuperCell object generated toy dataset, regenerate supercells using gamma 10 50. function recomputeSupercells. store output list, one element per gamma value. end list containing 2 elements. 1st element contains supercells generated using gamma = 10, 2nd contains supercells generated using gamma = 50. output generated recomputeSupercells essentially list: supercell_expression_matrix: data.table object contains marker expression supercell. supercell_cell_map: data.table maps cell corresponding supercell. mentioned , gamma dictates granularity supercells. Compared previous run gamma set 20, get supercells gamma = 10, less gamma = 50. Let’s see ’s case.","code":"addt_gamma_vals <- c(10, 50) supercells_addt_gamma <- lapply(addt_gamma_vals, function(gam) {     recomputeSupercells(         dt = dat,         sc_objects = supercells$supercell_object,         markers = marker_cols_asinh,         sample_colname = sample_col,         cell_id_colname = cell_id_col,         gam = gam     ) }) supercells_addt_gamma[[1]] #> $supercell_expression_matrix #>       Marker_1_asinh Marker_2_asinh Marker_3_asinh Marker_4_asinh #>                <num>          <num>          <num>          <num> #>    1:      0.9696783       1.972155       1.721013       1.276304 #>    2:      1.0124308       1.987264       1.778276       1.221415 #>    3:      1.1291710       1.992491       1.766599       1.217734 #>    4:      0.9216853       1.982625       1.739405       1.282888 #>    5:      0.9276912       1.977609       1.777766       1.342842 #>   ---                                                             #> 2996:      1.1350469       1.869372       0.814109       1.957647 #> 2997:      1.2317083       1.822277       1.109015       1.847673 #> 2998:      1.2935757       1.846235       1.195668       1.897921 #> 2999:      1.2896211       1.863785       1.019648       1.892519 #> 3000:      1.1427232       1.895304       1.016605       1.962564 #>       Marker_5_asinh Marker_6_asinh Marker_7_asinh Marker_8_asinh #>                <num>          <num>          <num>          <num> #>    1:      0.9654589       1.541381       1.618511       1.219360 #>    2:      0.8991693       1.637705       1.684431       1.339687 #>    3:      1.0711284       1.728192       1.590427       1.370154 #>    4:      1.0809710       1.622236       1.600255       1.398368 #>    5:      0.6954213       1.594101       1.664940       1.411748 #>   ---                                                             #> 2996:      1.9499659       1.344071       2.044141       1.939838 #> 2997:      1.9554664       1.619313       1.984121       1.954528 #> 2998:      2.0205453       1.568201       2.059242       2.041662 #> 2999:      1.9874414       1.553717       2.027931       1.900983 #> 3000:      2.0199546       1.401617       1.999470       1.970249 #>       Marker_9_asinh Marker_10_asinh Marker_11_asinh Marker_12_asinh #>                <num>           <num>           <num>           <num> #>    1:       1.848784        1.892726       1.9783000       1.3134378 #>    2:       1.880648        1.926755       2.0112972       1.1213923 #>    3:       1.874392        1.925758       2.0316442       1.1066837 #>    4:       1.900757        1.906717       2.0092665       1.2250326 #>    5:       1.895166        1.920280       2.0176838       1.2407724 #>   ---                                                                #> 2996:       1.620515        1.492665       1.1477082       0.9446480 #> 2997:       1.664717        1.532521       1.2167830       0.9298399 #> 2998:       1.720427        1.391957       1.0542911       0.8148562 #> 2999:       1.718376        1.322157       0.7917405       0.8976586 #> 3000:       1.556032        1.621228       1.1417019       1.0045321 #>       Marker_13_asinh Marker_14_asinh Marker_15_asinh   Sample #>                 <num>           <num>           <num>   <char> #>    1:       0.9497961        1.426577       1.6016374 Sample_1 #>    2:       1.0677681        1.530339       1.4807448 Sample_1 #>    3:       0.8760023        1.455008       1.5400428 Sample_1 #>    4:       0.8745441        1.365429       1.5336967 Sample_1 #>    5:       1.0326050        1.463607       1.5553632 Sample_1 #>   ---                                                          #> 2996:       2.0707835        1.533181       1.0094283 Sample_3 #> 2997:       2.0329529        1.419476       0.6864491 Sample_3 #> 2998:       2.0709370        1.381706       1.0013768 Sample_3 #> 2999:       2.0692234        1.286251       1.0528215 Sample_3 #> 3000:       2.1206257        1.342568       1.1691764 Sample_3 #>                          SuperCellId #>                               <char> #>    1:    SuperCell_1_Sample_Sample_1 #>    2:    SuperCell_2_Sample_Sample_1 #>    3:    SuperCell_3_Sample_Sample_1 #>    4:    SuperCell_4_Sample_Sample_1 #>    5:    SuperCell_5_Sample_Sample_1 #>   ---                                #> 2996:  SuperCell_996_Sample_Sample_3 #> 2997:  SuperCell_997_Sample_Sample_3 #> 2998:  SuperCell_998_Sample_Sample_3 #> 2999:  SuperCell_999_Sample_Sample_3 #> 3000: SuperCell_1000_Sample_Sample_3 #>  #> $supercell_cell_map #>                          SuperCellID     CellId   Sample #>                               <char>     <char>   <char> #>     1:  SuperCell_39_Sample_Sample_1     Cell_1 Sample_1 #>     2: SuperCell_696_Sample_Sample_1     Cell_2 Sample_1 #>     3:  SuperCell_46_Sample_Sample_1     Cell_3 Sample_1 #>     4: SuperCell_951_Sample_Sample_1     Cell_4 Sample_1 #>     5: SuperCell_103_Sample_Sample_1     Cell_5 Sample_1 #>    ---                                                   #> 29996: SuperCell_483_Sample_Sample_3 Cell_29996 Sample_3 #> 29997:  SuperCell_24_Sample_Sample_3 Cell_29997 Sample_3 #> 29998: SuperCell_661_Sample_Sample_3 Cell_29998 Sample_3 #> 29999:  SuperCell_41_Sample_Sample_3 Cell_29999 Sample_3 #> 30000: SuperCell_789_Sample_Sample_3 Cell_30000 Sample_3 n_supercells_gamma20 <- nrow(supercells$supercell_expression_matrix) n_supercells_gamma10 <- nrow(     supercells_addt_gamma[[1]]$supercell_expression_matrix ) n_supercells_gamma50 <- nrow(     supercells_addt_gamma[[2]]$supercell_expression_matrix ) n_supercells_gamma10 > n_supercells_gamma20 #> [1] TRUE n_supercells_gamma50 < n_supercells_gamma20 #> [1] TRUE"},{"path":"https://phipsonlab.github.io/SuperCellCyto/articles/how_to_create_supercells.html","id":"specifying-different-gamma-value-for-different-samples","dir":"Articles","previous_headings":"Controlling supercells granularity","what":"Specifying different gamma value for different samples","title":"How to create supercells","text":"future, may add ability specify different gam value different samples. now, want , need break data multiple data.table objects, containing data 1 sample, run runSuperCellCyto function different gam parameter value. Something like following: Subsequently, extract combine supercell_expression_matrix supercell_cell_map, need use rbind:","code":"n_markers <- 10 dat <- simCytoData(nmarkers = n_markers) markers_col <- paste0(\"Marker_\", seq_len(n_markers)) sample_col <- \"Sample\" cell_id_col <- \"Cell_Id\"  samples <- unique(dat[[sample_col]]) gam_values <- c(10, 20, 10)  supercells_diff_gam <- lapply(seq_len(length(samples)), function(i) {     sample <- samples[i]     gam <- gam_values[i]     dat_samp <- dat[dat$Sample == sample, ]     supercell_samp <- runSuperCellCyto(         dt = dat_samp,         markers = markers_col,         sample_colname = sample_col,         cell_id_colname = cell_id_col,         gam = gam     )     return(supercell_samp) }) supercell_expression_matrix <- do.call(     \"rbind\", lapply(         supercells_diff_gam, function(x) x[[\"supercell_expression_matrix\"]]     ) )  supercell_cell_map <- do.call(     \"rbind\", lapply(         supercells_diff_gam, function(x) x[[\"supercell_cell_map\"]]     ) ) rbind(     head(supercell_expression_matrix, n = 3),     tail(supercell_expression_matrix, n = 3) ) #>     Marker_1  Marker_2 Marker_3  Marker_4 Marker_5  Marker_6  Marker_7 Marker_8 #>        <num>     <num>    <num>     <num>    <num>     <num>     <num>    <num> #> 1:  6.511185  8.683492 6.773297 12.854907 10.49031 15.711709  7.177395 17.55178 #> 2:  7.135506  9.407189 7.076024 12.788735 12.37267 14.117383  7.072052 17.42942 #> 3:  6.323042  7.843839 6.425065 13.886867 10.88569 15.240742  6.568253 17.73703 #> 4: 18.799466 16.238249 6.407039 11.033295 15.60010  4.155191 16.978654 14.63903 #> 5: 16.284303 14.418969 7.385808  9.703229 12.78168  3.250727 16.656518 13.68402 #> 6: 16.969357 13.645203 7.800918 11.033554 11.44928  3.254663 17.845143 15.15761 #>     Marker_9 Marker_10   Sample                   SuperCellId #>        <num>     <num>   <char>                        <char> #> 1: 17.122190 12.693334 Sample_1   SuperCell_1_Sample_Sample_1 #> 2: 16.670828 11.585651 Sample_1   SuperCell_2_Sample_Sample_1 #> 3: 17.822578 14.319694 Sample_1   SuperCell_3_Sample_Sample_1 #> 4:  7.558093  6.610632 Sample_2 SuperCell_498_Sample_Sample_2 #> 5:  7.616852  7.626072 Sample_2 SuperCell_499_Sample_Sample_2 #> 6:  7.770940  6.301986 Sample_2 SuperCell_500_Sample_Sample_2 rbind(head(supercell_cell_map, n = 3), tail(supercell_cell_map, n = 3)) #>                      SuperCellID     CellId   Sample #>                           <char>     <char>   <char> #> 1: SuperCell_139_Sample_Sample_1     Cell_1 Sample_1 #> 2: SuperCell_299_Sample_Sample_1     Cell_2 Sample_1 #> 3: SuperCell_462_Sample_Sample_1     Cell_3 Sample_1 #> 4:  SuperCell_58_Sample_Sample_2 Cell_19998 Sample_2 #> 5: SuperCell_287_Sample_Sample_2 Cell_19999 Sample_2 #> 6: SuperCell_230_Sample_Sample_2 Cell_20000 Sample_2"},{"path":"https://phipsonlab.github.io/SuperCellCyto/articles/how_to_create_supercells.html","id":"mixing-cells-from-different-samples-in-a-supercell","dir":"Articles","previous_headings":"","what":"Mixing cells from different samples in a supercell","title":"How to create supercells","text":"whatever reason don’t mind (perhaps point want) supercell contain cells different biological samples, still need sample column data.table. However, need essentially set value column exactly one unique value. way, SuperCellCyto treat cells coming one sample. Just note, parallel processing feature SuperCellCyto won’t work essentially 1 sample nothing SuperCellCyto parallelise.","code":""},{"path":"https://phipsonlab.github.io/SuperCellCyto/articles/how_to_create_supercells.html","id":"i-have-more-cells-than-ram-in-my-computer","dir":"Articles","previous_headings":"","what":"I have more cells than RAM in my computer","title":"How to create supercells","text":"dataset huge constantly running RAM generating supercells? thing happens solution . Since supercells generated sample independent others can easily break process. example: Load subset samples (say 1-10). Generate supercells samples. Save output using qs package. Extract supercell_expression_matrix supercell_cell_map, export csv file using data.table’s fwrite function. Load another sets samples (say 11-20), rinse repeat step 2-4. processed samples, can load supercell_expression_matrix supercell_cell_map csv files analyse . want regenerate supercells using different gamma values, load relevant output saved using qs package relevant data (remember note output belongs sets samples!), run recomputeSupercells function.","code":""},{"path":"https://phipsonlab.github.io/SuperCellCyto/articles/how_to_create_supercells.html","id":"session-information","dir":"Articles","previous_headings":"","what":"Session information","title":"How to create supercells","text":"","code":"sessionInfo() #> R version 4.5.1 (2025-06-13) #> Platform: x86_64-pc-linux-gnu #> Running under: Ubuntu 24.04.2 LTS #>  #> Matrix products: default #> BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3  #> LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0 #>  #> locale: #>  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8        #>  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8    #>  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C           #> [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C    #>  #> time zone: UTC #> tzcode source: system (glibc) #>  #> attached base packages: #> [1] parallel  stats     graphics  grDevices utils     datasets  methods   #> [8] base      #>  #> other attached packages: #> [1] BiocParallel_1.42.1  SuperCellCyto_0.99.1 BiocStyle_2.36.0     #>  #> loaded via a namespace (and not attached): #>  [1] cli_3.6.5           knitr_1.50          rlang_1.1.6         #>  [4] xfun_0.53           textshaping_1.0.1   data.table_1.17.8   #>  [7] jsonlite_2.0.0      plyr_1.8.9          htmltools_0.5.8.1   #> [10] ragg_1.4.0          sass_0.4.10         rmarkdown_2.29      #> [13] grid_4.5.1          evaluate_1.0.4      jquerylib_0.1.4     #> [16] fastmap_1.2.0       yaml_2.3.10         lifecycle_1.0.4     #> [19] bookdown_0.44       BiocManager_1.30.26 compiler_4.5.1      #> [22] igraph_2.1.4        codetools_0.2-20    fs_1.6.6            #> [25] Rcpp_1.1.0          pkgconfig_2.0.3     htmlwidgets_1.6.4   #> [28] lattice_0.22-7      systemfonts_1.2.3   digest_0.6.37       #> [31] SuperCell_1.0.1     R6_2.6.1            RANN_2.6.2          #> [34] magrittr_2.0.3      Matrix_1.7-3        bslib_0.9.0         #> [37] tools_4.5.1         pkgdown_2.1.3       cachem_1.1.0        #> [40] desc_1.4.3"},{"path":"https://phipsonlab.github.io/SuperCellCyto/articles/how_to_prepare_data.html","id":"performing-quality-control","dir":"Articles","previous_headings":"","what":"Performing Quality Control","title":"How to Prepare Data for SuperCellCyto","text":"Prior creating supercells, ’s crucial ensure dataset undergone thorough quality control (QC). want retain single, live cells remove debris, doublets, dead cells. Additionally, also important perform compensation correct fluorescence spillover (Flow data) adjust signal overlap spillover different metal isotopse (Cytof data). well-prepared dataset key obtaining reliable supercells SuperCellCyto. Several R packages available performing QC cytometry data. Notable among PeacoQC, CATALYST, CytoExploreR. packages well maintained continuously updated. make sure information provide quickly go date, highly recommend consult packages’ respective vignettes detailed guidance use QC data. manuscript, used CytoExploreR QC Oetjen_bcell flow cytometry data CATALYST QC Trussart_cytofruv Cytof data. specific scripts used can found Github: b_cell_identification/gate_flow_data.R Oetjen_bcell data. batch_correction/prepare_data.R Trussart_cytofruv data. scripts adapted used CytofRUV manuscript. Oetjen_bcell data, used following gating strategy post compensation: FSC-H FSC-isolate single events. (Also check SSC-H vs SSC-). FSC-SSC-remove debris. Live/Dead SSC-isolate live cells. following resulting single live cells manually gated Oetjen_bcell data.  completing QC process, clean data either CSV FCS file formats. next section guide load files proceed preparing data SuperCellCyto.","code":"knitr::include_graphics(     \"figures/oetjen_bcell_single_live_cells.png\",      error = FALSE )"},{"path":"https://phipsonlab.github.io/SuperCellCyto/articles/how_to_prepare_data.html","id":"preparing-fcscsv-files-for-supercellcyto","dir":"Articles","previous_headings":"","what":"Preparing FCS/CSV files for SuperCellCyto","title":"How to Prepare Data for SuperCellCyto","text":"use SuperCellCyto, input data must formatted data.table object. Briefly, data.table enhanced version R native data.frame object. package offers fast processing large data.frame.","code":""},{"path":"https://phipsonlab.github.io/SuperCellCyto/articles/how_to_prepare_data.html","id":"cell-id-column","dir":"Articles","previous_headings":"Preparing FCS/CSV files for SuperCellCyto","what":"Cell ID column","title":"How to Prepare Data for SuperCellCyto","text":"Additionally, cell data.table must also unique identifier. purpose ID allow SuperCell uniquely identify cell dataset. come super handy later /need work cells belong supercells, .e., need expand supercells . Generally, need create ID . dataset won’t come ID already embedded . tutorial, call column denotes cell ID cell_id. dataset, can name column however like, e.g., id, cell_identity, etc. Just make sure note column name need later create supercells.","code":""},{"path":"https://phipsonlab.github.io/SuperCellCyto/articles/how_to_prepare_data.html","id":"sample-column","dir":"Articles","previous_headings":"Preparing FCS/CSV files for SuperCellCyto","what":"Sample column","title":"How to Prepare Data for SuperCellCyto","text":"Lastly, cell data.table object must also associated sample. information must stored column later pass function creates supercells. Generally, sample typically refers biological sample cell came . create supercells, necessary column dataset. ensure supercell cells exactly one sample. cases, make sense mix cells different biological samples one supercell. Additionally (important), SuperCellCyto can process multiple samples parallel, , needs know sample information. 1 biological sample dataset? matter. still need sample column dataset. difference column 1 unique value. can name column however like, e.g., Samp, Cell_Samp, etc. tutorial, call column sample. Just make sure note column name need later create supercells.","code":""},{"path":"https://phipsonlab.github.io/SuperCellCyto/articles/how_to_prepare_data.html","id":"preparing-csv-files","dir":"Articles","previous_headings":"Preparing FCS/CSV files for SuperCellCyto","what":"Preparing CSV files","title":"How to Prepare Data for SuperCellCyto","text":"Loading CSV files data.table object straightforward. can use fread function data.table package. ’s install : example, let’s load two CSV files containing subsampled data Levine_32dim dataset used SuperCellCyto manuscript. file represents sample (H1 H2), sample name appended file name: Let’s break done. specify location csv files csv_files vector corresponding sample names samples vector. Levine_32dim_H1_sub.csv belongs sample H1 Levine_32dim_H2_sub.csv belongs sample H2. use lapply simultaneously iterate element csv_files samples vector. csv file corresponding sample, read csv file variable dat_a_sample using fread function. assign sample id new column called sample. result, get list dat containing 2 data.table objects, 1 object per csv file. use rbindlist function data.table package merge list one data.table object. create new column cell_id gives cell unique id Cell_1, Cell_2, etc.","code":"install.packages(\"data.table\") library(data.table)  csv_files <- c(     system.file(         \"extdata\", \"Levine_32dim_H1_sub.csv\", package = \"SuperCellCyto\"     ),     system.file(         \"extdata\", \"Levine_32dim_H2_sub.csv\", package = \"SuperCellCyto\"     ) )  samples <- c(\"H1\", \"H2\")  dat <- lapply(seq_len(length(samples)), function(i) {     csv_file <- csv_files[i]     sample <- samples[i]      dat_a_sample <- fread(csv_file)     dat_a_sample$sample <- sample      return(dat_a_sample) }) dat <- rbindlist(dat)  dat[, cell_id := paste0(\"Cell_\", seq_len(nrow(dat)))]  head(dat) #>      Time Cell_length      DNA1     DNA2   CD45RA       CD133       CD19 #>     <num>       <int>     <num>    <num>    <num>       <num>      <num> #> 1: 307428          27 169.91125 262.3192 2.338830 -0.15333985 -0.2056334 #> 2:  80712          13  50.91230 181.1320 2.129232  3.35638666 -0.1013980 #> 3: 111390          16 126.93545 269.4199 1.613719 -0.07193317  0.1116483 #> 4:  14088          31 142.67317 283.4645 4.100985  0.09366111 19.4974289 #> 5: 284190          53  98.28069 187.2090 4.289627  0.56254190 12.2265682 #> 6: 481997          35 112.29634 162.4416 6.089430  0.01665318 -0.1943735 #>           CD22       CD11b        CD4          CD8        CD34        Flt3 #>          <num>       <num>      <num>        <num>       <num>       <num> #> 1: -0.19720075 32.13040161 0.78105438 -0.071934469  1.53498471  0.84833205 #> 2:  3.05647945 14.23928833 0.53373063 -0.007943562 -0.09401329 -0.13234507 #> 3: -0.07421356  2.20701027 9.75063324 -0.034266483  0.53720337 -0.05749827 #> 4:  5.07963181 -0.07880223 0.05995781  0.009049721 -0.19206744  3.36803102 #> 5: 10.81768703  1.82670891 1.30010796 -0.187664956  2.05419374  2.72891521 #> 6:  1.43817198  5.79350042 0.64789140 54.004249573  0.28843120  1.01514077 #>           CD20    CXCR4     CD235ab     CD45       CD123     CD321        CD14 #>          <num>    <num>       <num>    <num>       <num>     <num>       <num> #> 1: -0.08676258 3.488938  0.82301176 313.8038  0.30909532 46.484669  0.05072345 #> 2: -0.04217101 1.364644 -0.13094166 207.2459  1.76594567 22.532978 -0.19256826 #> 3:  0.09777651 3.880993  2.00220966 750.4200 -0.06809702  9.515447 -0.05956535 #> 4:  0.64118648 2.911314 -0.08744399 169.4798  1.25776207  9.218699  1.09861076 #> 5: 15.34162998 9.303430  6.34135485 751.0563  0.05031190 10.463912  1.11993504 #> 6:  3.84020925 3.520693  2.93023992 868.4937 -0.04488884 19.107010  0.62120903 #>           CD33     CD47       CD11c          CD7      CD15        CD16 #>          <num>    <num>       <num>        <num>     <num>       <num> #> 1:  2.09802437 20.96871 20.76318550 -0.007966662 0.7279212 -0.03067662 #> 2:  7.35230541 27.49848 15.13398170 -0.087256350 0.7187206  0.41139653 #> 3: -0.16046160 53.51268 -0.19080050  1.044164538 2.1075230 -0.14510959 #> 4:  0.18614264 55.07846 -0.07061907  0.948859751 1.2470639  1.12294865 #> 5:  0.15872155 40.63973  4.64010382 -0.195279136 4.5712810 -0.10192144 #> 6: -0.09832545 29.65497  6.15759659 12.104630470 0.5801706 -0.11606000 #>         CD44        CD38      CD13         CD3       CD61       CD117     CD49d #>        <num>       <num>     <num>       <num>      <num>       <num>     <num> #> 1:  95.71002   5.1124768 5.1056433   0.5827813 -0.1684093 -0.02967962  6.557199 #> 2: 185.51929   7.4784145 0.3580886   1.8861074  1.9233229 -0.14122920  1.088500 #> 3:  33.95839   0.6161237 0.3045178 462.1258240  0.7625037 -0.03500306  5.997476 #> 4:  32.46420 249.4612885 1.2526705   0.7302832  3.2274778 -0.18526185  8.533935 #> 5:  98.09428  43.5352974 2.8327518   0.1868679  2.1032026  0.01776284 12.400333 #> 6:  65.91293   2.0126576 1.2817017 390.3737793  2.4605207  0.33154550  5.214703 #>        HLA-DR       CD64         CD41  Viability file_number event_number #>         <num>      <num>        <num>      <num>       <int>        <int> #> 1: 112.467545  6.9157209  0.083808646  1.7268630          94       257088 #> 2:  12.206795 30.7242870  7.753727913  3.7120194          94        80655 #> 3:  -0.046793 -0.1739236 -0.080375805  0.7011412          94       116394 #> 4:   8.965122  0.3391838 -0.005531122  0.2978864          94         5618 #> 5: 174.952667  0.4361930  1.834125400 13.2743187          94       241699 #> 6:   0.648035 -0.1803290  0.389085352  0.4543665          94       363564 #>    sample cell_id #>    <char>  <char> #> 1:     H1  Cell_1 #> 2:     H1  Cell_2 #> 3:     H1  Cell_3 #> 4:     H1  Cell_4 #> 5:     H1  Cell_5 #> 6:     H1  Cell_6"},{"path":"https://phipsonlab.github.io/SuperCellCyto/articles/how_to_prepare_data.html","id":"preparing-fcs-files","dir":"Articles","previous_headings":"Preparing FCS/CSV files for SuperCellCyto","what":"Preparing FCS files","title":"How to Prepare Data for SuperCellCyto","text":"FCS files, commonly used cytometry, require specific handling. can read FCS files using flowCore package available Bioconductor convert data.table object. Let’s load two small FCS files Anti-PD1 data FlowRepository. code used flowCore’s read.flowSet function first read FCS files flowSet object. lapply rbindlist used convert one data.table object containing data FCS files. FCS files belong two different patients, patient 9 15. shall use sample ID. make sure correctly map filenames patients, first create new data.table object containing mapping FileName sample name, using merge.data.table add data.table object. also create new column cell_id gives cell unique id Cell_1, Cell_2, etc. CSV FCS files loaded data.table objects, next step transform data appropriately SuperCellCyto.","code":"library(flowCore) library(data.table)  fs <- read.flowSet(     path = system.file(         \"extdata\", package = \"SuperCellCyto\"     ),     pattern = \"\\\\.fcs$\" )  dat_list <- lapply(seq_along(fs), function(i) {     df <- as.data.table(exprs(fs[[i]]))      # concatenate channel and marker name as column names     names(df) <- markernames(fs[[i]])      # add a column showing the filename     df$file_name <- sampleNames(fs)[i]      return(df) })  # collate all the files into one dat <- rbindlist(dat_list)  dat #>      209Bi_CD11b 162Dy_CD11c  163Dy_CD7 166Er_CD209  167Er_CD38 151Eu_CD123 #>            <num>       <num>      <num>       <num>       <num>       <num> #>   1:    2.596444    0.000000  24.233248   2.4271879   0.2497845  0.01359761 #>   2:   20.172476   29.508638 253.930161   2.0283859  63.4845619  0.00000000 #>   3:  224.771057  377.262421  20.755060   5.5264821 111.7728882 10.33144855 #>   4:  711.252808  192.961227  16.039482   2.7453365  13.4806919  1.71946943 #>   5:  435.131073  203.836838   5.983910   0.0000000   4.2271118  1.08193946 #>  ---                                                                        #> 569:  337.737152  160.982407   1.724550   0.8164008  10.8179998  1.87148142 #> 570:   48.965187    3.454711  55.719162   0.7539494  20.6741104  0.00000000 #> 571:  326.666168   58.792435   4.358847   0.0000000   8.6697922  0.00000000 #> 572:    7.255682    0.000000   3.552515   0.0000000   2.9367595  0.43651727 #> 573:  349.350769   31.072611   1.050743   0.0000000   5.4545450  5.87748337 #>      153Eu_CD62L 152Gd_CD66b 154Gd_ICAM-1 155Gd_CD1c  156Gd_CD86 160Gd_CD14 #>            <num>       <num>        <num>      <num>       <num>      <num> #>   1:  276.736237   0.0000000    6.3661394 0.72167069   0.0000000   0.000000 #>   2:    7.522890   0.0000000   16.6949806 0.00000000   0.9723848   2.370285 #>   3:    2.523962   0.0000000  480.9555969 2.87207913 109.6869812  41.803619 #>   4:    1.439798   0.0000000  125.3002014 0.00000000   5.1308088  19.226034 #>   5:    3.030660   0.0000000   54.1368217 0.03324713  23.3382854  14.204736 #>  ---                                                                        #> 569:    0.000000   0.0000000  158.1088257 2.28826094  15.2002096   5.657256 #> 570:    3.414483   0.0000000    0.9569107 2.11766744   0.7849152   4.082072 #> 571:    0.000000   0.0000000    1.1182016 0.00000000   0.0000000   0.000000 #> 572:    2.556602   0.6154923    0.0000000 0.00000000   0.0000000   0.000000 #> 573:    3.925082   0.0000000   43.5083618 0.00000000   4.2216253   8.216695 #>       165Ho_CD16 191Ir_DNA1 193Ir_DNA2 175Lu_PD-L1 142Nd_CD19 146Nd_CD64 #>            <num>      <num>      <num>       <num>      <num>      <num> #>   1:   0.0000000   40.33384   76.70573   0.0000000 0.00000000   5.452389 #>   2: 126.4256592   55.11267  150.46278   3.4527724 0.00000000   1.922374 #>   3:   2.0556698   91.42932  161.59381   8.3969393 0.00000000  12.956987 #>   4:   0.0000000   75.32122  160.41399   0.1078656 0.00000000  12.841355 #>   5:   0.5523136   79.88800  142.12471   0.6882498 0.00000000  19.308508 #>  ---                                                                     #> 569:   0.0000000   65.31769  148.84435   0.1064020 0.00000000  22.941177 #> 570:  51.3577194   65.16866  129.46790   3.5496852 0.36609724   2.852356 #> 571:   0.9855582   92.97505  151.65977   0.0000000 0.03485066   6.290884 #> 572:   0.0000000   65.07745  111.99138   0.5479890 0.63119560   0.000000 #> 573:   0.0000000  114.67633  191.50166   0.0000000 0.00000000  12.638340 #>          195Pt     196Pt 198Pt_Dead 147Sm_CD303 148Sm_CD34 149Sm_CD141 #>          <num>     <num>      <num>       <num>      <num>       <num> #>   1: 0.0000000 0.0000000  15.199163   0.0000000  1.2188276    2.482402 #>   2: 2.6318610 0.0000000  32.325874   0.0000000  0.2467884    0.000000 #>   3: 0.2854315 0.3602256  10.119688   0.7021694  7.2453775   17.055792 #>   4: 1.7483448 1.6977243   2.457203   0.0000000  1.1050161    6.811901 #>   5: 0.0000000 2.7839208  13.680239   0.8908378  0.0000000   18.400421 #>  ---                                                                   #> 569: 0.0000000 0.0000000  16.751446   2.6801469  0.6307272    2.710867 #> 570: 0.3765990 0.0000000  20.695446   0.0000000  3.0734873    1.968072 #> 571: 0.1897834 0.0000000  16.076082   0.9444249  0.4878764    6.945232 #> 572: 0.0000000 0.0000000  23.279974   0.0000000  0.0000000    0.000000 #> 573: 0.0000000 4.0132923  12.463143   0.8065992  1.6200637    4.190233 #>      150Sm_CD61  169Tm_CD33  89Y_CD45  170Yb_CD3  173Yb_CD56 174Yb_HLA-DR #>           <num>       <num>     <num>      <num>       <num>        <num> #>   1:  65.015724   1.1326860  37.52760  9.0316811  0.00000000     6.807954 #>   2:  25.455738   0.1979908 225.64279  0.9135754  8.38446426     5.601559 #>   3:  75.056625 134.7255249 458.79022 12.2988071 10.31508160   403.328308 #>   4:  21.287003  58.7627487 387.78836  1.1870043  0.00000000    88.822212 #>   5:  26.795689  35.0521393 107.94828  0.3782265  5.60699320   104.159081 #>  ---                                                                      #> 569:  36.163387  22.8519592 227.01973  2.7277973  0.02519703   188.378601 #> 570:  37.537052   3.3848262  48.12588  4.6816015  2.54012346    10.622149 #> 571:  16.739002  10.3474064  60.64515  0.6677586  0.00000000    15.465885 #> 572:  15.469506   0.0000000  11.47586  8.9600000  0.00000000     0.000000 #> 573:   8.587144  18.8689251  52.50787  0.6892268  1.88265443    13.542062 #>                                file_name #>                                   <char> #>   1: Data23_Panel3_base_NR4_Patient9.fcs #>   2: Data23_Panel3_base_NR4_Patient9.fcs #>   3: Data23_Panel3_base_NR4_Patient9.fcs #>   4: Data23_Panel3_base_NR4_Patient9.fcs #>   5: Data23_Panel3_base_NR4_Patient9.fcs #>  ---                                     #> 569: Data23_Panel3_base_R5_Patient15.fcs #> 570: Data23_Panel3_base_R5_Patient15.fcs #> 571: Data23_Panel3_base_R5_Patient15.fcs #> 572: Data23_Panel3_base_R5_Patient15.fcs #> 573: Data23_Panel3_base_R5_Patient15.fcs sample_info <- data.table(     sample = c(\"patient9\", \"patient15\"),     file_name = c(         \"Data23_Panel3_base_NR4_Patient9.fcs\",         \"Data23_Panel3_base_R5_Patient15.fcs\"     ) ) dat <- merge.data.table(     x = dat,     y = sample_info,     by = \"file_name\" )  dat[, cell_id := paste0(\"Cell_\", seq_len(nrow(dat)))]"},{"path":"https://phipsonlab.github.io/SuperCellCyto/articles/how_to_prepare_data.html","id":"data-transformation","dir":"Articles","previous_headings":"","what":"Data Transformation","title":"How to Prepare Data for SuperCellCyto","text":"using SuperCellCyto, ’s essential apply appropriate data transformations. common method data transformation cytometry arcsinh transformation, inverse hyperbolic arcsinh transformation. transformation requires specifying cofactor, affects representation low-end data. Typically, cofactor 5 used Cytof data 150 Flow data. vignette focus transformation process rather cofactor selection. ’ll use Levine_32dim dataset loaded earlier CSV files. First, need select markers transformed. Usually, markers transformed SuperCellCyto. However, can choose exclude specific markers needed: transformation, ’ll use cofactor 5 apply arcsinh transformation. transformation, new columns “_asinh” appended indicate transformed markers. data now transformed, ’re ready create supercells using SuperCellCyto. Please refer create supercells vignette detailed instructions.","code":"markers <- c(     \"209Bi_CD11b\", \"162Dy_CD11c\", \"163Dy_CD7\", \"166Er_CD209\", \"167Er_CD38\",     \"151Eu_CD123\", \"153Eu_CD62L\", \"152Gd_CD66b\", \"154Gd_ICAM-1\", \"155Gd_CD1c\",     \"156Gd_CD86\", \"160Gd_CD14\", \"165Ho_CD16\", \"191Ir_DNA1\", \"193Ir_DNA2\",     \"175Lu_PD-L1\", \"142Nd_CD19\", \"146Nd_CD64\", \"195Pt\", \"196Pt\",     \"198Pt_Dead\", \"147Sm_CD303\", \"148Sm_CD34\", \"149Sm_CD141\", \"150Sm_CD61\",     \"169Tm_CD33\", \"89Y_CD45\", \"170Yb_CD3\", \"173Yb_CD56\", \"174Yb_HLA-DR\" ) new_cols <- paste0(markers, \"_asinh\") cf <- 5 dat[, (new_cols) := lapply(.SD, function(x) asinh(x / cf)), .SDcols = markers]"},{"path":"https://phipsonlab.github.io/SuperCellCyto/articles/how_to_prepare_data.html","id":"session-information","dir":"Articles","previous_headings":"","what":"Session information","title":"How to Prepare Data for SuperCellCyto","text":"","code":"sessionInfo() #> R version 4.5.1 (2025-06-13) #> Platform: x86_64-pc-linux-gnu #> Running under: Ubuntu 24.04.2 LTS #>  #> Matrix products: default #> BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3  #> LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0 #>  #> locale: #>  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8        #>  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8    #>  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C           #> [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C    #>  #> time zone: UTC #> tzcode source: system (glibc) #>  #> attached base packages: #> [1] stats     graphics  grDevices utils     datasets  methods   base      #>  #> other attached packages: #> [1] flowCore_2.20.0   data.table_1.17.8 BiocStyle_2.36.0  #>  #> loaded via a namespace (and not attached): #>  [1] cli_3.6.5           knitr_1.50          rlang_1.1.6         #>  [4] xfun_0.53           png_0.1-8           generics_0.1.4      #>  [7] textshaping_1.0.1   jsonlite_2.0.0      RProtoBufLib_2.20.0 #> [10] S4Vectors_0.46.0    htmltools_0.5.8.1   stats4_4.5.1        #> [13] ragg_1.4.0          sass_0.4.10         Biobase_2.68.0      #> [16] rmarkdown_2.29      evaluate_1.0.4      jquerylib_0.1.4     #> [19] fastmap_1.2.0       yaml_2.3.10         lifecycle_1.0.4     #> [22] bookdown_0.44       BiocManager_1.30.26 compiler_4.5.1      #> [25] fs_1.6.6            htmlwidgets_1.6.4   systemfonts_1.2.3   #> [28] digest_0.6.37       R6_2.6.1            cytolib_2.20.0      #> [31] bslib_0.9.0         tools_4.5.1         matrixStats_1.5.0   #> [34] BiocGenerics_0.54.0 pkgdown_2.1.3       cachem_1.1.0        #> [37] desc_1.4.3"},{"path":"https://phipsonlab.github.io/SuperCellCyto/articles/interoperability_with_sce.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Interoperability with SingleCellExperiment","text":"vignette demonstrates integrate SuperCellCyto results cytometry data stored SingleCellExperiment (SCE) objects, analyse SuperCellCyto output using Bioconductor packages take SCE objects input. use subsampled Levine_32dim dataset stored SCE object illustrate create supercells conduct downstream analyses.","code":"library(SuperCellCyto) library(qs) library(scran) library(BiocSingular) library(scater) library(bluster) library(data.table)"},{"path":"https://phipsonlab.github.io/SuperCellCyto/articles/interoperability_with_sce.html","id":"preparing-sce-object","dir":"Articles","previous_headings":"","what":"Preparing SCE object","title":"Interoperability with SingleCellExperiment","text":"first load subsampled Levine_32dim data, stored qs using qread function. data stored counts assay. subset include markers need perform downstream analysis, transform using arcsinh transformation, store transformed data logcounts assay.","code":"sce <- qread(system.file(     \"extdata\", \"Levine_32dim_sce_sub.qs\", package = \"SuperCellCyto\" )) sce #> class: SingleCellExperiment  #> dim: 39 1400  #> metadata(0): #> assays(1): counts #> rownames(39): Time Cell_length ... file_number event_number #> rowData names(3): channel_name marker_name marker_class #> colnames(1400): cell_561 cell_321 ... cell_103890 cell_104094 #> colData names(3): population cell_id sample #> reducedDimNames(0): #> mainExpName: NULL #> altExpNames(0): markers <- c(     \"CD45RA\", \"CD133\", \"CD19\", \"CD22\", \"CD11b\", \"CD4\", \"CD8\",     \"CD34\", \"Flt3\", \"CD20\", \"CXCR4\", \"CD235ab\", \"CD45\", \"CD123\", \"CD321\",     \"CD14\", \"CD33\", \"CD47\", \"CD11c\", \"CD7\", \"CD15\", \"CD16\", \"CD44\", \"CD38\",     \"CD13\", \"CD3\", \"CD61\", \"CD117\",     \"CD49d\", \"HLA-DR\", \"CD64\", \"CD41\" )  # keep only the relevant markers sce <- sce[markers, ]  # to store arcsinh transformed data exprs(sce) <- asinh(counts(sce) / 5)  sce #> class: SingleCellExperiment  #> dim: 32 1400  #> metadata(0): #> assays(2): counts logcounts #> rownames(32): CD45RA CD133 ... CD64 CD41 #> rowData names(3): channel_name marker_name marker_class #> colnames(1400): cell_561 cell_321 ... cell_103890 cell_104094 #> colData names(3): population cell_id sample #> reducedDimNames(0): #> mainExpName: NULL #> altExpNames(0):"},{"path":"https://phipsonlab.github.io/SuperCellCyto/articles/interoperability_with_sce.html","id":"run-supercellcyto","dir":"Articles","previous_headings":"","what":"Run SuperCellCyto","title":"Interoperability with SingleCellExperiment","text":"SuperCellCyto requires input data data.table format. Therefore, need extract arcsinh-transformed data data.table object, add sample information IDs cells. Note SCE typically stores cells columns features rows. SuperCellCyto, conversely, requires cells rows features columns, format typical cytometry data typically cells features. Hence, transpose extracted data accordingly creating data.table object. can now embed supercell ID colData SCE object.","code":"dt <- data.table(t(exprs(sce))) dt$sample <- colData(sce)$sample dt$cell_id <- colnames(sce)  supercells <- runSuperCellCyto(     dt = dt,     markers = markers,     sample_colname = \"sample\",     cell_id_colname = \"cell_id\",     gam = 5 )  head(supercells$supercell_expression_matrix) #>       CD45RA      CD133         CD19       CD22      CD11b          CD4 #>        <num>      <num>        <num>      <num>      <num>        <num> #> 1: 0.3527464 0.36965658  0.052225408 0.15136864 0.38488737  0.196023673 #> 2: 0.4041729 0.11507111 -0.006932994 0.14693022 0.31907116 -0.003634473 #> 3: 0.2887375 0.36023125  0.056967849 0.07522713 0.24452473  0.029621008 #> 4: 0.4649379 0.08945479  0.103484348 0.11839183 0.14487231  1.042568045 #> 5: 0.9805149 0.19259931  2.047843479 0.63399673 0.19205448  0.069494473 #> 6: 0.5039989 0.04109535  1.140960742 0.16492283 0.02102912  0.071198534 #>            CD8       CD34       Flt3       CD20     CXCR4    CD235ab     CD45 #>          <num>      <num>      <num>      <num>     <num>      <num>    <num> #> 1: 0.007764969 3.50239704 0.34908410 0.05885608 0.8318448 0.08275919 4.150848 #> 2: 0.398832012 0.03705595 0.08254384 0.11077190 0.1816196 0.23423737 4.807796 #> 3: 0.141084382 2.86064160 0.15894138 0.09338509 0.5989438 0.28179014 3.957416 #> 4: 0.071286889 0.10101316 0.29710281 0.03730981 1.2497923 0.67063325 5.886074 #> 5: 0.119244014 0.18210858 0.18761215 1.92656431 1.6019596 0.55462384 4.901840 #> 6: 0.004411946 0.11332847 0.18281316 0.16633969 0.5100604 0.28425575 2.570437 #>         CD123     CD321         CD14         CD33     CD47     CD11c        CD7 #>         <num>     <num>        <num>        <num>    <num>     <num>      <num> #> 1: 0.65958207 3.4777525  0.002602230  0.152636911 3.397630 0.5570696 0.12059033 #> 2: 0.01079346 0.7022473  0.040223896 -0.019154034 2.348988 0.3813772 3.63888594 #> 3: 0.68153776 3.1851073  0.015196514  0.117996726 2.756822 0.3060572 0.07848237 #> 4: 0.11592253 2.1491149 -0.007858091 -0.002039228 3.268248 0.2132838 1.08816761 #> 5: 0.62460814 2.2506667  0.075977004  0.514268184 3.562088 0.2269047 0.01379916 #> 6: 0.06874399 0.8415449  0.068690241  0.240470325 3.154016 0.4181508 0.07325880 #>          CD15        CD16     CD44      CD38      CD13        CD3       CD61 #>         <num>       <num>    <num>     <num>     <num>      <num>      <num> #> 1: 0.63687911 0.195011598 4.262887 2.6031938 0.4192431 0.46531929 0.06761204 #> 2: 0.17664753 0.905724996 1.632231 2.8565129 0.2514765 0.27068380 0.25558748 #> 3: 0.44514407 0.026423501 2.874195 1.9066412 0.4908399 0.24716531 0.17950440 #> 4: 0.08441551 0.004227474 3.640311 0.5495787 0.2311405 5.36168058 0.39291676 #> 5: 0.14494562 0.252655577 2.822493 5.0658843 0.5187125 0.33558106 0.19615231 #> 6: 0.30214595 0.281831160 3.819350 5.8639208 1.0289835 0.07946019 0.08158021 #>          CD117     CD49d     HLA-DR       CD64       CD41 sample #>          <num>     <num>      <num>      <num>      <num> <char> #> 1:  1.19031991 1.3604618 2.75321307 0.16150006 0.18985821     H1 #> 2:  0.06541793 0.4496903 0.14374144 0.18547915 0.06282481     H1 #> 3:  0.83249351 0.9205626 2.58482319 0.20073796 0.21266848     H1 #> 4:  0.29209802 0.4707183 0.17818566 0.04568237 0.07765066     H1 #> 5:  0.10129956 1.3608945 2.20287695 0.09954007 0.17256851     H1 #> 6: -0.01764885 1.4263210 0.07484084 0.06353135 0.06840618     H1 #>              SuperCellId #>                   <char> #> 1: SuperCell_1_Sample_H1 #> 2: SuperCell_2_Sample_H1 #> 3: SuperCell_3_Sample_H1 #> 4: SuperCell_4_Sample_H1 #> 5: SuperCell_5_Sample_H1 #> 6: SuperCell_6_Sample_H1 colData(sce)$supercell_id <-  factor(supercells$supercell_cell_map$SuperCellID) head(colData(sce)) #> DataFrame with 6 rows and 4 columns #>          population     cell_id   sample           supercell_id #>            <factor> <character> <factor>               <factor> #> cell_561  Basophils    cell_561       H1 SuperCell_94_Sample_H1 #> cell_321  Basophils    cell_321       H1 SuperCell_51_Sample_H1 #> cell_153  Basophils    cell_153       H1 SuperCell_29_Sample_H1 #> cell_74   Basophils     cell_74       H1 SuperCell_51_Sample_H1 #> cell_228  Basophils    cell_228       H1 SuperCell_51_Sample_H1 #> cell_146  Basophils    cell_146       H1 SuperCell_25_Sample_H1"},{"path":"https://phipsonlab.github.io/SuperCellCyto/articles/interoperability_with_sce.html","id":"analyse-supercells-as-sce-object","dir":"Articles","previous_headings":"","what":"Analyse Supercells as SCE object","title":"Interoperability with SingleCellExperiment","text":"number supercells less number cells SCE object, store supercell expression matrix separate SCE object. allows us use Bioconductor packages analyse supercells. code essentially transpose supercell expression matrix, making supercells columns markers rows, store logcounts assay new SCE object. also populate colData SuperCellId sample name supercell. supercell expression matrix now SCE format, can perform downstream analyses clustering drawing UMAP plots using Bioconductor packages.  functions operate SCE object work. example, can use plotExpression scater package create violin plots markers clusters. Note, y-axis says “logcounts”, data actually arcsinh transformed, log transformed.","code":"supercell_sce <- SingleCellExperiment(     list(logcounts = t(         supercells$supercell_expression_matrix[, markers, with = FALSE]     )),     colData = DataFrame(         SuperCellId = supercells$supercell_expression_matrix$SuperCellId,         sample = supercells$supercell_expression_matrix$sample     ) ) colnames(supercell_sce) <- colData(supercell_sce)$SuperCellId supercell_sce #> class: SingleCellExperiment  #> dim: 32 280  #> metadata(0): #> assays(1): logcounts #> rownames(32): CD45RA CD133 ... CD64 CD41 #> rowData names(0): #> colnames(280): SuperCell_1_Sample_H1 SuperCell_2_Sample_H1 ... #>   SuperCell_139_Sample_H2 SuperCell_140_Sample_H2 #> colData names(2): SuperCellId sample #> reducedDimNames(0): #> mainExpName: NULL #> altExpNames(0): set.seed(42)  supercell_sce <- fixedPCA(     supercell_sce,     rank = 10,     subset.row = NULL,     BSPARAM = RandomParam() ) supercell_sce <- runUMAP(supercell_sce, dimred = \"PCA\")  clusters <- clusterCells(     supercell_sce, use.dimred = \"PCA\",     BLUSPARAM = SNNGraphParam(cluster.fun = \"leiden\") )  colLabels(supercell_sce) <- clusters  plotReducedDim(supercell_sce, dimred = \"UMAP\", colour_by = \"label\") plotExpression(     supercell_sce, c(\"CD4\", \"CD8\", \"CD19\", \"CD34\", \"CD11b\"),     x = \"label\", colour_by = \"sample\" )"},{"path":"https://phipsonlab.github.io/SuperCellCyto/articles/interoperability_with_sce.html","id":"transfer-information-from-supercells-sce-object-to-single-cell-sce-object","dir":"Articles","previous_headings":"","what":"Transfer information from supercells SCE object to single cell SCE object","title":"Interoperability with SingleCellExperiment","text":"transfer analysis results (e.g., clusters) supercell SCE object back single-cell SCE object, need data wrangling. vital ensure order analysis results (e.g., clusters) aligns cell order SCE object. Using cluster information example, need first extract colData SCE objects two separate data.table objects. use merge.data.table match merge using supercell ID common identifiers. Make sure set sort parameter FALSE set x colData single cell SCE object. ensures order resulting data.table aligns order colData single-cell SCE object. Finally, can add cluster assignment column colData single-cell SCE object. Visualise UMAP plot.  violin plot see distribution marker expressions. Note, y-axis says “logcounts”, data actually arcsinh transformed, log transformed.","code":"cell_id_sce <- data.table(as.data.frame(colData(sce))) supercell_cluster <- data.table(as.data.frame(colData(supercell_sce))) cell_id_sce_with_clusters <- merge.data.table(     x = cell_id_sce,     y = supercell_cluster,     by.x = \"supercell_id\",     by.y = \"SuperCellId\",     sort = FALSE ) colData(sce)$cluster <- cell_id_sce_with_clusters$label sce <- fixedPCA(sce, rank = 10, subset.row = NULL, BSPARAM = RandomParam()) sce <- runUMAP(sce, dimred = \"PCA\")  plotReducedDim(sce, dimred = \"UMAP\", colour_by = \"cluster\") plotExpression(     sce, c(\"CD4\", \"CD8\", \"CD19\", \"CD34\", \"CD11b\"),     x = \"cluster\", colour_by = \"sample\" )"},{"path":"https://phipsonlab.github.io/SuperCellCyto/articles/interoperability_with_sce.html","id":"session-information","dir":"Articles","previous_headings":"","what":"Session information","title":"Interoperability with SingleCellExperiment","text":"","code":"sessionInfo() #> R version 4.5.1 (2025-06-13) #> Platform: x86_64-pc-linux-gnu #> Running under: Ubuntu 24.04.2 LTS #>  #> Matrix products: default #> BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3  #> LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0 #>  #> locale: #>  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8        #>  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8    #>  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C           #> [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C    #>  #> time zone: UTC #> tzcode source: system (glibc) #>  #> attached base packages: #> [1] stats4    stats     graphics  grDevices utils     datasets  methods   #> [8] base      #>  #> other attached packages: #>  [1] data.table_1.17.8           bluster_1.18.0              #>  [3] scater_1.36.0               ggplot2_3.5.2               #>  [5] BiocSingular_1.24.0         scran_1.36.0                #>  [7] scuttle_1.18.0              SingleCellExperiment_1.30.1 #>  [9] SummarizedExperiment_1.38.1 Biobase_2.68.0              #> [11] GenomicRanges_1.60.0        GenomeInfoDb_1.44.2         #> [13] IRanges_2.42.0              S4Vectors_0.46.0            #> [15] BiocGenerics_0.54.0         generics_0.1.4              #> [17] MatrixGenerics_1.20.0       matrixStats_1.5.0           #> [19] qs_0.27.3                   SuperCellCyto_0.99.1        #> [21] BiocStyle_2.36.0            #>  #> loaded via a namespace (and not attached): #>  [1] gridExtra_2.3           rlang_1.1.6             magrittr_2.0.3          #>  [4] compiler_4.5.1          systemfonts_1.2.3       vctrs_0.6.5             #>  [7] pkgconfig_2.0.3         crayon_1.5.3            fastmap_1.2.0           #> [10] XVector_0.48.0          labeling_0.4.3          SuperCell_1.0.1         #> [13] rmarkdown_2.29          UCSC.utils_1.4.0        ggbeeswarm_0.7.2        #> [16] ragg_1.4.0              xfun_0.53               cachem_1.1.0            #> [19] beachmat_2.24.0         jsonlite_2.0.0          DelayedArray_0.34.1     #> [22] BiocParallel_1.42.1     irlba_2.3.5.1           parallel_4.5.1          #> [25] cluster_2.1.8.1         R6_2.6.1                bslib_0.9.0             #> [28] RColorBrewer_1.1-3      limma_3.64.3            jquerylib_0.1.4         #> [31] Rcpp_1.1.0              bookdown_0.44           knitr_1.50              #> [34] FNN_1.1.4.1             Matrix_1.7-3            igraph_2.1.4            #> [37] tidyselect_1.2.1        abind_1.4-8             yaml_2.3.10             #> [40] viridis_0.6.5           stringfish_0.17.0       codetools_0.2-20        #> [43] lattice_0.22-7          tibble_3.3.0            plyr_1.8.9              #> [46] withr_3.0.2             evaluate_1.0.4          desc_1.4.3              #> [49] RcppParallel_5.1.10     pillar_1.11.0           BiocManager_1.30.26     #> [52] scales_1.4.0            RApiSerialize_0.1.4     glue_1.8.0              #> [55] metapod_1.16.0          tools_4.5.1             BiocNeighbors_2.2.0     #> [58] ScaledMatrix_1.16.0     locfit_1.5-9.12         RANN_2.6.2              #> [61] fs_1.6.6                cowplot_1.2.0           grid_4.5.1              #> [64] edgeR_4.6.3             GenomeInfoDbData_1.2.14 beeswarm_0.4.0          #> [67] vipor_0.4.7             cli_3.6.5               rsvd_1.0.5              #> [70] textshaping_1.0.1       S4Arrays_1.8.1          viridisLite_0.4.2       #> [73] dplyr_1.1.4             uwot_0.2.3              gtable_0.3.6            #> [76] sass_0.4.10             digest_0.6.37           SparseArray_1.8.1       #> [79] ggrepel_0.9.6           dqrng_0.4.1             htmlwidgets_1.6.4       #> [82] farver_2.1.2            htmltools_0.5.8.1       pkgdown_2.1.3           #> [85] lifecycle_1.0.4         httr_1.4.7              statmod_1.5.0"},{"path":"https://phipsonlab.github.io/SuperCellCyto/articles/interoperability_with_seurat.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Interoperability with Seurat","text":"can integrate SuperCellCyto”s output cytometry data stored Seurat objects? possible store results SuperCellCyto Seurat objects subsequent analysis using Seurat? answer yes. vignette, demonstrate process using subsampled Levine_32dim dataset used manuscript stored Seurat object. show create supercells data analyse using Seurat.","code":"library(qs) library(Seurat) library(data.table) library(SuperCellCyto)  set.seed(42)"},{"path":"https://phipsonlab.github.io/SuperCellCyto/articles/interoperability_with_seurat.html","id":"preparing-seurat-object","dir":"Articles","previous_headings":"","what":"Preparing Seurat object","title":"Interoperability with Seurat","text":"subsampled Levine_32dim data stored qs object. begin loading data using qread function qs package. data stored originalexp assay, counts data slots containing raw data. running SuperCellCyto, first: Subset data retain markers need perform downstream analysis. Perform arcsinh transformation, store transformed data data slot originalexp assay.","code":"seurat_obj <- qread(system.file(     \"extdata\", \"Levine_32dim_seurat_sub.qs\", package = \"SuperCellCyto\" )) seurat_obj #> An object of class Seurat  #> 39 features across 1400 samples within 1 assay  #> Active assay: originalexp (39 features, 0 variable features) #>  2 layers present: counts, data markers <- c(     \"CD45RA\", \"CD133\", \"CD19\", \"CD22\", \"CD11b\", \"CD4\", \"CD8\", \"CD34\",     \"Flt3\", \"CD20\", \"CXCR4\", \"CD235ab\", \"CD45\", \"CD123\", \"CD321\", \"CD14\",     \"CD33\", \"CD47\", \"CD11c\", \"CD7\", \"CD15\", \"CD16\", \"CD44\", \"CD38\", \"CD13\",     \"CD3\", \"CD61\", \"CD117\", \"CD49d\", \"HLA-DR\", \"CD64\", \"CD41\" )  # keep only the relevant markers seurat_obj <- seurat_obj[markers, ]  # to store arcsinh transformed data seurat_obj[[\"originalexp\"]]$data <- asinh(     seurat_obj[[\"originalexp\"]]$counts / 5 )  seurat_obj #> An object of class Seurat  #> 32 features across 1400 samples within 1 assay  #> Active assay: originalexp (32 features, 0 variable features) #>  2 layers present: counts, data"},{"path":"https://phipsonlab.github.io/SuperCellCyto/articles/interoperability_with_seurat.html","id":"run-supercellcyto","dir":"Articles","previous_headings":"","what":"Run SuperCellCyto","title":"Interoperability with Seurat","text":"SuperCellCyto requires input data data.table format. Hence, extract arcsinh-transformed data Seurat object, format data.table, include sample information cell IDs. ”s important note Seurat objects typically store cells columns features (markers genes) rows. Since SuperCellCyto expects cells rows features columns, also transpose data. transposing preparing data table, run runSuperCellCyto function, passing required parameters including markers, sample column name, cell ID column name, gamma value. can now embed supercell ID metadata Seurat object.","code":"# check.names set to FALSE so HLA-DR is not replaced with HLA.DR dt <- data.table(     t(data.frame(seurat_obj[[\"originalexp\"]]$data, check.names = FALSE)) ) # add the cell_id and sample metadata dt <- cbind(dt, seurat_obj[[c(\"cell_id\", \"sample\")]])  supercells <- runSuperCellCyto(     dt = dt,     markers = markers,     sample_colname = \"sample\",     cell_id_colname = \"cell_id\",     gam = 5 )  head(supercells$supercell_expression_matrix) #>       CD45RA      CD133         CD19       CD22      CD11b          CD4 #>        <num>      <num>        <num>      <num>      <num>        <num> #> 1: 0.3527464 0.36965658  0.052225408 0.15136864 0.38488737  0.196023673 #> 2: 0.4041729 0.11507111 -0.006932994 0.14693022 0.31907116 -0.003634473 #> 3: 0.2887375 0.36023125  0.056967849 0.07522713 0.24452473  0.029621008 #> 4: 0.4649379 0.08945479  0.103484348 0.11839183 0.14487231  1.042568045 #> 5: 0.9805149 0.19259931  2.047843479 0.63399673 0.19205448  0.069494473 #> 6: 0.5039989 0.04109535  1.140960742 0.16492283 0.02102912  0.071198534 #>            CD8       CD34       Flt3       CD20     CXCR4    CD235ab     CD45 #>          <num>      <num>      <num>      <num>     <num>      <num>    <num> #> 1: 0.007764969 3.50239704 0.34908410 0.05885608 0.8318448 0.08275919 4.150848 #> 2: 0.398832012 0.03705595 0.08254384 0.11077190 0.1816196 0.23423737 4.807796 #> 3: 0.141084382 2.86064160 0.15894138 0.09338509 0.5989438 0.28179014 3.957416 #> 4: 0.071286889 0.10101316 0.29710281 0.03730981 1.2497923 0.67063325 5.886074 #> 5: 0.119244014 0.18210858 0.18761215 1.92656431 1.6019596 0.55462384 4.901840 #> 6: 0.004411946 0.11332847 0.18281316 0.16633969 0.5100604 0.28425575 2.570437 #>         CD123     CD321         CD14         CD33     CD47     CD11c        CD7 #>         <num>     <num>        <num>        <num>    <num>     <num>      <num> #> 1: 0.65958207 3.4777525  0.002602230  0.152636911 3.397630 0.5570696 0.12059033 #> 2: 0.01079346 0.7022473  0.040223896 -0.019154034 2.348988 0.3813772 3.63888594 #> 3: 0.68153776 3.1851073  0.015196514  0.117996726 2.756822 0.3060572 0.07848237 #> 4: 0.11592253 2.1491149 -0.007858091 -0.002039228 3.268248 0.2132838 1.08816761 #> 5: 0.62460814 2.2506667  0.075977004  0.514268184 3.562088 0.2269047 0.01379916 #> 6: 0.06874399 0.8415449  0.068690241  0.240470325 3.154016 0.4181508 0.07325880 #>          CD15        CD16     CD44      CD38      CD13        CD3       CD61 #>         <num>       <num>    <num>     <num>     <num>      <num>      <num> #> 1: 0.63687911 0.195011598 4.262887 2.6031938 0.4192431 0.46531929 0.06761204 #> 2: 0.17664753 0.905724996 1.632231 2.8565129 0.2514765 0.27068380 0.25558748 #> 3: 0.44514407 0.026423501 2.874195 1.9066412 0.4908399 0.24716531 0.17950440 #> 4: 0.08441551 0.004227474 3.640311 0.5495787 0.2311405 5.36168058 0.39291676 #> 5: 0.14494562 0.252655577 2.822493 5.0658843 0.5187125 0.33558106 0.19615231 #> 6: 0.30214595 0.281831160 3.819350 5.8639208 1.0289835 0.07946019 0.08158021 #>          CD117     CD49d     HLA-DR       CD64       CD41 sample #>          <num>     <num>      <num>      <num>      <num> <char> #> 1:  1.19031991 1.3604618 2.75321307 0.16150006 0.18985821     H1 #> 2:  0.06541793 0.4496903 0.14374144 0.18547915 0.06282481     H1 #> 3:  0.83249351 0.9205626 2.58482319 0.20073796 0.21266848     H1 #> 4:  0.29209802 0.4707183 0.17818566 0.04568237 0.07765066     H1 #> 5:  0.10129956 1.3608945 2.20287695 0.09954007 0.17256851     H1 #> 6: -0.01764885 1.4263210 0.07484084 0.06353135 0.06840618     H1 #>              SuperCellId #>                   <char> #> 1: SuperCell_1_Sample_H1 #> 2: SuperCell_2_Sample_H1 #> 3: SuperCell_3_Sample_H1 #> 4: SuperCell_4_Sample_H1 #> 5: SuperCell_5_Sample_H1 #> 6: SuperCell_6_Sample_H1 seurat_obj$supercell_id <- factor(supercells$supercell_cell_map$SuperCellID) head(seurat_obj[[]]) #>          orig.ident nCount_originalexp nFeature_originalexp population  cell_id #> cell_561       cell           782.3311                   23  Basophils cell_561 #> cell_321       cell           849.1107                   28  Basophils cell_321 #> cell_153       cell          1349.6991                   21  Basophils cell_153 #> cell_74        cell           908.6923                   23  Basophils  cell_74 #> cell_228       cell           723.2195                   27  Basophils cell_228 #> cell_146       cell           444.4285                   22  Basophils cell_146 #>          sample           supercell_id #> cell_561     H1 SuperCell_94_Sample_H1 #> cell_321     H1 SuperCell_51_Sample_H1 #> cell_153     H1 SuperCell_29_Sample_H1 #> cell_74      H1 SuperCell_51_Sample_H1 #> cell_228     H1 SuperCell_51_Sample_H1 #> cell_146     H1 SuperCell_25_Sample_H1"},{"path":"https://phipsonlab.github.io/SuperCellCyto/articles/interoperability_with_seurat.html","id":"analyse-supercells-as-seurat-object","dir":"Articles","previous_headings":"","what":"Analyse Supercells as Seurat object","title":"Interoperability with Seurat","text":"supercell expression matrix, fewer supercells number cells Seurat object, best stored separate Seurat object. allows us use Seurat”s functions analysis. , first transpose expression matrix, ensuring cells columns markers rows, create new Seurat object default RNA assay. data counts slots RNA assay set contain marker expression. supercell marker expression stored Seurat object, can proceed performing downstream analysis clustering creating UMAP plots.","code":"supercell_mat <- t(     supercells$supercell_expression_matrix[, markers, with = FALSE] ) colnames(supercell_mat) <- supercells$supercell_expression_matrix$SuperCellId supercell_seurat_obj <- CreateSeuratObject(counts = supercell_mat) #> Warning: Data is of class matrix. Coercing to dgCMatrix. supercell_seurat_obj[[\"RNA\"]]$data <- supercell_seurat_obj[[\"RNA\"]]$counts  supercell_seurat_obj #> An object of class Seurat  #> 32 features across 280 samples within 1 assay  #> Active assay: RNA (32 features, 0 variable features) #>  2 layers present: counts, data # Have to do this, otherwise Seurat will complain supercell_seurat_obj <- ScaleData(supercell_seurat_obj)  supercell_seurat_obj <- RunPCA(     object = supercell_seurat_obj,     npcs = 10,     nfeatures.print = 1,     approx = FALSE,     seed.use = 42,     features = markers )  supercell_seurat_obj <- FindNeighbors(supercell_seurat_obj, dims = 1:10) supercell_seurat_obj <- FindClusters(supercell_seurat_obj, resolution = 0.5) #> Modularity Optimizer version 1.3.0 by Ludo Waltman and Nees Jan van Eck #>  #> Number of nodes: 280 #> Number of edges: 6252 #>  #> Running Louvain algorithm... #> Maximum modularity in 10 random starts: 0.8590 #> Number of communities: 7 #> Elapsed time: 0 seconds supercell_seurat_obj <- RunUMAP(supercell_seurat_obj, dims = 1:10) #> Warning: The default method for RunUMAP has changed from calling Python UMAP via reticulate to the R-native UWOT using the cosine metric #> To use Python UMAP via reticulate, set umap.method to 'umap-learn' and metric to 'correlation' #> This message will be shown once per session  DimPlot(supercell_seurat_obj, reduction = \"umap\") FeaturePlot(     supercell_seurat_obj,     features = c(\"CD4\", \"CD8\", \"CD19\", \"CD34\", \"CD11b\"), ncol = 3 ) #> Warning: The `slot` argument of `FetchData()` is deprecated as of SeuratObject 5.0.0. #> ℹ Please use the `layer` argument instead. #> ℹ The deprecated feature was likely used in the Seurat package. #>   Please report the issue at <https://github.com/satijalab/seurat/issues>. #> This warning is displayed once every 8 hours. #> Call `lifecycle::last_lifecycle_warnings()` to see where this warning was #> generated."},{"path":"https://phipsonlab.github.io/SuperCellCyto/articles/interoperability_with_seurat.html","id":"transfer-information-from-supercells-to-single-cell-seurat-object","dir":"Articles","previous_headings":"","what":"Transfer information from supercells to single-cell Seurat object","title":"Interoperability with Seurat","text":"transfer information (e.g., clusters) obtained analyzing supercells back single cells, need data wrangling. key ensuring order new information aligns order cells Seurat object. demonstrate using cluster information example. first extract metadata single-cell Seurat object clustering information supercells Seurat object two different data.table objects. merge using merge.data.table, setting sort parameter FALSE x parameter data.table containing metadata single-cell Seurat object. ensure result order metadata single-cell Seurat object. merging, can add cluster assignment metadata single-cell Seurat object. visualise cluster assignments marker expressions clustered single cell data.","code":"clusters <- data.table(     supercell_id = colnames(supercell_seurat_obj),     cluster = as.vector(Idents(supercell_seurat_obj)) )  cell_metadata <- seurat_obj[[]] cell_metadata <- merge.data.table(     x = cell_metadata,     y = clusters,     by = \"supercell_id\",     sort = FALSE ) seurat_obj$cluster <- cell_metadata$cluster Idents(seurat_obj) <- \"cluster\" seurat_obj <- ScaleData(seurat_obj) #> Warning: The `slot` argument of `GetAssayData()` is deprecated as of SeuratObject 5.0.0. #> ℹ Please use the `layer` argument instead. #> ℹ The deprecated feature was likely used in the Seurat package. #>   Please report the issue at <https://github.com/satijalab/seurat/issues>. #> This warning is displayed once every 8 hours. #> Call `lifecycle::last_lifecycle_warnings()` to see where this warning was #> generated. #> Warning: The `slot` argument of `SetAssayData()` is deprecated as of SeuratObject 5.0.0. #> ℹ Please use the `layer` argument instead. #> ℹ The deprecated feature was likely used in the Seurat package. #>   Please report the issue at <https://github.com/satijalab/seurat/issues>. #> This warning is displayed once every 8 hours. #> Call `lifecycle::last_lifecycle_warnings()` to see where this warning was #> generated. seurat_obj <- RunPCA(     object = seurat_obj,     npcs = 10,     nfeatures.print = 1,     approx = FALSE,     seed.use = 42,     features = markers )  seurat_obj <- FindNeighbors(seurat_obj, dims = 1:10) seurat_obj <- FindClusters(seurat_obj, resolution = 0.5) #> Modularity Optimizer version 1.3.0 by Ludo Waltman and Nees Jan van Eck #>  #> Number of nodes: 1400 #> Number of edges: 45134 #>  #> Running Louvain algorithm... #> Maximum modularity in 10 random starts: 0.9088 #> Number of communities: 9 #> Elapsed time: 0 seconds seurat_obj <- RunUMAP(seurat_obj, dims = 1:10)  DimPlot(seurat_obj, reduction = \"umap\") FeaturePlot(     seurat_obj,     features = c(\"CD4\", \"CD8\", \"CD19\", \"CD34\", \"CD11b\"), ncol = 3 )"},{"path":"https://phipsonlab.github.io/SuperCellCyto/articles/interoperability_with_seurat.html","id":"session-information","dir":"Articles","previous_headings":"","what":"Session information","title":"Interoperability with Seurat","text":"","code":"sessionInfo() #> R version 4.5.1 (2025-06-13) #> Platform: x86_64-pc-linux-gnu #> Running under: Ubuntu 24.04.2 LTS #>  #> Matrix products: default #> BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3  #> LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0 #>  #> locale: #>  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8        #>  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8    #>  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C           #> [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C    #>  #> time zone: UTC #> tzcode source: system (glibc) #>  #> attached base packages: #> [1] stats     graphics  grDevices utils     datasets  methods   base      #>  #> other attached packages: #> [1] future_1.67.0        SuperCellCyto_0.99.1 data.table_1.17.8    #> [4] Seurat_5.3.0         SeuratObject_5.1.0   sp_2.2-0             #> [7] qs_0.27.3            BiocStyle_2.36.0     #>  #> loaded via a namespace (and not attached): #>   [1] RColorBrewer_1.1-3     jsonlite_2.0.0         magrittr_2.0.3         #>   [4] spatstat.utils_3.1-5   farver_2.1.2           rmarkdown_2.29         #>   [7] fs_1.6.6               ragg_1.4.0             vctrs_0.6.5            #>  [10] ROCR_1.0-11            spatstat.explore_3.5-2 htmltools_0.5.8.1      #>  [13] sass_0.4.10            sctransform_0.4.2      parallelly_1.45.1      #>  [16] KernSmooth_2.23-26     bslib_0.9.0            htmlwidgets_1.6.4      #>  [19] desc_1.4.3             ica_1.0-3              plyr_1.8.9             #>  [22] plotly_4.11.0          zoo_1.8-14             cachem_1.1.0           #>  [25] igraph_2.1.4           mime_0.13              lifecycle_1.0.4        #>  [28] pkgconfig_2.0.3        Matrix_1.7-3           R6_2.6.1               #>  [31] fastmap_1.2.0          fitdistrplus_1.2-4     shiny_1.11.1           #>  [34] digest_0.6.37          patchwork_1.3.1        tensor_1.5.1           #>  [37] RSpectra_0.16-2        irlba_2.3.5.1          textshaping_1.0.1      #>  [40] labeling_0.4.3         progressr_0.15.1       spatstat.sparse_3.1-0  #>  [43] httr_1.4.7             polyclip_1.10-7        abind_1.4-8            #>  [46] compiler_4.5.1         withr_3.0.2            BiocParallel_1.42.1    #>  [49] fastDummies_1.7.5      MASS_7.3-65            tools_4.5.1            #>  [52] lmtest_0.9-40          httpuv_1.6.16          future.apply_1.20.0    #>  [55] goftest_1.2-3          glue_1.8.0             nlme_3.1-168           #>  [58] promises_1.3.3         grid_4.5.1             Rtsne_0.17             #>  [61] cluster_2.1.8.1        reshape2_1.4.4         generics_0.1.4         #>  [64] gtable_0.3.6           spatstat.data_3.1-8    tidyr_1.3.1            #>  [67] RApiSerialize_0.1.4    stringfish_0.17.0      spatstat.geom_3.5-0    #>  [70] RcppAnnoy_0.0.22       ggrepel_0.9.6          RANN_2.6.2             #>  [73] pillar_1.11.0          stringr_1.5.1          spam_2.11-1            #>  [76] RcppHNSW_0.6.0         later_1.4.3            splines_4.5.1          #>  [79] dplyr_1.1.4            lattice_0.22-7         survival_3.8-3         #>  [82] deldir_2.0-4           tidyselect_1.2.1       miniUI_0.1.2           #>  [85] pbapply_1.7-4          knitr_1.50             gridExtra_2.3          #>  [88] bookdown_0.44          scattermore_1.2        xfun_0.53              #>  [91] matrixStats_1.5.0      stringi_1.8.7          lazyeval_0.2.2         #>  [94] yaml_2.3.10            evaluate_1.0.4         codetools_0.2-20       #>  [97] SuperCell_1.0.1        tibble_3.3.0           BiocManager_1.30.26    #> [100] cli_3.6.5              uwot_0.2.3             RcppParallel_5.1.10    #> [103] xtable_1.8-4           reticulate_1.43.0      systemfonts_1.2.3      #> [106] jquerylib_0.1.4        Rcpp_1.1.0             globals_0.18.0         #> [109] spatstat.random_3.4-1  png_0.1-8              spatstat.univar_3.1-4  #> [112] parallel_4.5.1         pkgdown_2.1.3          ggplot2_3.5.2          #> [115] dotCall64_1.2          listenv_0.9.1          viridisLite_0.4.2      #> [118] scales_1.4.0           ggridges_0.5.6         crayon_1.5.3           #> [121] purrr_1.1.0            rlang_1.1.6            cowplot_1.2.0"},{"path":"https://phipsonlab.github.io/SuperCellCyto/articles/using_supercellcyto_for_stratified_summarising.html","id":"session-information","dir":"Articles","previous_headings":"","what":"Session information","title":"Using SuperCellCyto for Stratified Summarising","text":"","code":"sessionInfo() #> R version 4.5.1 (2025-06-13) #> Platform: x86_64-pc-linux-gnu #> Running under: Ubuntu 24.04.2 LTS #>  #> Matrix products: default #> BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3  #> LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0 #>  #> locale: #>  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8        #>  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8    #>  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C           #> [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C    #>  #> time zone: UTC #> tzcode source: system (glibc) #>  #> attached base packages: #> [1] stats     graphics  grDevices utils     datasets  methods   base      #>  #> other attached packages: #> [1] SuperCellCyto_0.99.1 BiocStyle_2.36.0     #>  #> loaded via a namespace (and not attached): #>  [1] cli_3.6.5           knitr_1.50          rlang_1.1.6         #>  [4] xfun_0.53           textshaping_1.0.1   data.table_1.17.8   #>  [7] jsonlite_2.0.0      plyr_1.8.9          htmltools_0.5.8.1   #> [10] ragg_1.4.0          sass_0.4.10         rmarkdown_2.29      #> [13] grid_4.5.1          evaluate_1.0.4      jquerylib_0.1.4     #> [16] fastmap_1.2.0       yaml_2.3.10         lifecycle_1.0.4     #> [19] bookdown_0.44       BiocManager_1.30.26 compiler_4.5.1      #> [22] igraph_2.1.4        codetools_0.2-20    fs_1.6.6            #> [25] Rcpp_1.1.0          pkgconfig_2.0.3     htmlwidgets_1.6.4   #> [28] BiocParallel_1.42.1 lattice_0.22-7      systemfonts_1.2.3   #> [31] digest_0.6.37       SuperCell_1.0.1     R6_2.6.1            #> [34] RANN_2.6.2          parallel_4.5.1      magrittr_2.0.3      #> [37] Matrix_1.7-3        bslib_0.9.0         tools_4.5.1         #> [40] pkgdown_2.1.3       cachem_1.1.0        desc_1.4.3"},{"path":"https://phipsonlab.github.io/SuperCellCyto/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Givanna Putri. Author, maintainer. George Howitt. Author. Felix Marsh-Wakefield. Author. Thomas Ashhurst. Author. Belinda Phipson. Author.","code":""},{"path":"https://phipsonlab.github.io/SuperCellCyto/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Putri, H G, Howitt, George, Marsh-Wakefield, Felix, Ashhurst, Myles T, Phipson, Belinda (2024). “SuperCellCyto: enabling efficient analysis large scale cytometry datasets.” Genome Biology. doi:10.1186/s13059-024-03229-3.","code":"@Article{,   title = {SuperCellCyto: enabling efficient analysis of large scale cytometry datasets},   author = {{Putri} and Givanna H and {Howitt} and {George} and {Marsh-Wakefield} and {Felix} and {Ashhurst} and Thomas Myles and {Phipson} and {Belinda}},   journal = {Genome Biology},   year = {2024},   doi = {https://doi.org/10.1186/s13059-024-03229-3}, }"},{"path":"https://phipsonlab.github.io/SuperCellCyto/index.html","id":"supercellcyto","dir":"","previous_headings":"","what":"SuperCell For Cytometry Data","title":"SuperCell For Cytometry Data","text":"SuperCellCyto extension SuperCell R package. Initially developed scRNAseq data, SuperCell aggregates cells similar transcriptomic profiles “supercells” (also known “metacells” scRNAseq literature). SuperCellCyto, ’ve tailored SuperCell package specifically cater cytometry data: Supercells now aggregating cells similar marker expressions. Supercells now created individual sample. adaptation ensures supercell encompasses cells exclusively one sample. processing sample independently, prevent intermixing cells different samples within supercells. Multiple samples can now processed parallel custom load balancing strategy. enhancement enables simultaneous generation supercells multiple samples, significantly reducing computational time required processing large datasets. Please report issues encounter.","code":""},{"path":"https://phipsonlab.github.io/SuperCellCyto/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"SuperCell For Cytometry Data","text":"can install stable version SuperCellCyto Bioconductor: , can install development version SuperCellCyto GitHub:","code":"# Install BiocManager if you haven't already if (!requireNamespace(\"BiocManager\", quietly = TRUE))     install.packages(\"BiocManager\") # Install SuperCellCyto from Bioconductor BiocManager::install(\"SuperCellCyto\") if (!requireNamespace(\"pak\", quietly = TRUE))     install.packages(\"pak\") # Install SuperCellCyto from GitHub pak::pak(\"phipsonlab/SuperCellCyto\")"},{"path":"https://phipsonlab.github.io/SuperCellCyto/index.html","id":"getting-started","dir":"","previous_headings":"","what":"Getting Started","title":"SuperCell For Cytometry Data","text":"best way get started SuperCellCyto explore package’s vignettes articles (available https://phipsonlab.github.io/SuperCellCyto/).","code":""},{"path":"https://phipsonlab.github.io/SuperCellCyto/index.html","id":"changelog","dir":"","previous_headings":"","what":"Changelog","title":"SuperCell For Cytometry Data","text":"list recent changes, please see NEWS.md file.","code":""},{"path":"https://phipsonlab.github.io/SuperCellCyto/index.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"SuperCell For Cytometry Data","text":"","code":"@article{putri2024supercellcyto,   title={SuperCellCyto: enabling efficient analysis of large scale cytometry datasets},   author={Putri, Givanna H and Howitt, George and Marsh-Wakefield, Felix and Ashhurst, Thomas M and Phipson, Belinda},   journal={Genome Biology},   volume={25},   number={1},   pages={89},   year={2024},   publisher={Springer} }"},{"path":"https://phipsonlab.github.io/SuperCellCyto/index.html","id":"code-of-conduct","dir":"","previous_headings":"","what":"Code of Conduct","title":"SuperCell For Cytometry Data","text":"Please note SuperCellCyto project released Contributor Code Conduct. contributing project, agree abide terms.","code":""},{"path":"https://phipsonlab.github.io/SuperCellCyto/index.html","id":"contribution-guide","dir":"","previous_headings":"","what":"Contribution guide","title":"SuperCell For Cytometry Data","text":"Please visit Contributing Guide","code":""},{"path":"https://phipsonlab.github.io/SuperCellCyto/reference/recomputeSupercells.html","id":null,"dir":"Reference","previous_headings":"","what":"Recompute supercells — recomputeSupercells","title":"Recompute supercells — recomputeSupercells","text":"Given supercell object, recreate supercells using different gamma value. Gamma value controls number supercells generated. smaller value, supercells get, vice versa. function run, need least run runSuperCellCyto() function !","code":""},{"path":"https://phipsonlab.github.io/SuperCellCyto/reference/recomputeSupercells.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Recompute supercells — recomputeSupercells","text":"","code":"recomputeSupercells(   dt,   sc_objects,   markers,   sample_colname,   cell_id_colname,   aggregation_method = c(\"mean\", \"median\"),   gam = 20 )"},{"path":"https://phipsonlab.github.io/SuperCellCyto/reference/recomputeSupercells.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Recompute supercells — recomputeSupercells","text":"dt data.table object containing cytometry data rows represent cells columns represent markers. sc_objects supercell_object returned runSuperCellCyto() function. markers character vector identifying markers create supercells . sample_colname character string identifying column dt denotes sample cell. cell_id_colname character string identifying column dt representing cell's unique ID. aggregation_method character string indicating aggregate cells supercells get expression matrix. Options \"mean\" \"median\". Defaults \"mean\". \"mean\", mean marker expressions across cells within individual supercell computed. \"median\", median marker expressions across cells within individual supercell computed. gam numeric value specifying gamma value regulates number supercells generated. Defaults 20.","code":""},{"path":"https://phipsonlab.github.io/SuperCellCyto/reference/recomputeSupercells.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Recompute supercells — recomputeSupercells","text":"list following components: supercell_expression_matrix:  data.table object contains marker expression supercell. marker expressions computed calculating mean marker expressions across cells within individual supercell. supercell_cell_map: data.table maps cell corresponding supercell. table essential identifying specific supercell cell allocated . proves particularly useful analyses require one expand supercells individual cell level.","code":""},{"path":"https://phipsonlab.github.io/SuperCellCyto/reference/recomputeSupercells.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Recompute supercells — recomputeSupercells","text":"Givanna Putri","code":""},{"path":"https://phipsonlab.github.io/SuperCellCyto/reference/recomputeSupercells.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Recompute supercells — recomputeSupercells","text":"","code":"set.seed(42) cyto_dat <- simCytoData(10, rep(1000, 3)) markers <- paste0(\"Marker_\", seq_len(10)) out_gam20 <- runSuperCellCyto(     dt = cyto_dat,     markers = markers,     sample_colname = \"Sample\",     cell_id_colname = \"Cell_Id\",     gam = 20 ) recomputed_sc <- recomputeSupercells(     dt = cyto_dat,     sc_objects = out_gam20$supercell_object,     markers = markers,     sample_colname = \"Sample\",     cell_id_colname = \"Cell_Id\",     gam = 50 )"},{"path":"https://phipsonlab.github.io/SuperCellCyto/reference/runSuperCellCyto.html","id":null,"dir":"Reference","previous_headings":"","what":"Run SuperCellCyto on Cytometry Data — runSuperCellCyto","title":"Run SuperCellCyto on Cytometry Data — runSuperCellCyto","text":"function creates supercells cytometry data formatted data.table object using SuperCellCyto algorithm. Please make sure read additional details better understand function works.","code":""},{"path":"https://phipsonlab.github.io/SuperCellCyto/reference/runSuperCellCyto.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run SuperCellCyto on Cytometry Data — runSuperCellCyto","text":"","code":"runSuperCellCyto(   dt,   markers,   sample_colname,   cell_id_colname,   n_pc = 10,   aggregation_method = c(\"mean\", \"median\"),   gam = 20,   k_knn = 5,   BPPARAM = SerialParam(),   load_balancing = FALSE )"},{"path":"https://phipsonlab.github.io/SuperCellCyto/reference/runSuperCellCyto.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run SuperCellCyto on Cytometry Data — runSuperCellCyto","text":"dt data.table object containing cytometry data rows represent cells columns represent markers. data.frame object, function try convert data.table object. warning message displayed happens. Otherwise, terminate. markers character vector identifying markers create supercells . sample_colname character string identifying column dt denotes sample cell. cell_id_colname character string identifying column dt representing cell's unique ID. n_pc numeric value specifying number principal components (PCs) compute marker expression matrix. Defaults 10. less 10 markers markers parameter, number PCs set however many markers markers parameter. aggregation_method character string specifying method used calculating marker expression supercells. Accepted values \"mean\" \"median\". Based choice, supercells' marker expression computed computing either mean median marker expression cells therein. default value \"mean\". value provided, function return error. gam numeric value specifying gamma value regulates number supercells generated. Defaults 20. k_knn numeric value specifying k value (number neighbours) used build kNN network. Defaults 5. BPPARAM BiocParallelParam-class object specifying parallel processing settings. Defaults SerialParam-class, meaning samples processed sequentially one . Refer additional details section parallel processing details. load_balancing logical value  indicating whether use custom load balancing scheme processing multiple samples parallel. Defaults FALSE. Refer additional details section parallel processing details.","code":""},{"path":"https://phipsonlab.github.io/SuperCellCyto/reference/runSuperCellCyto.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run SuperCellCyto on Cytometry Data — runSuperCellCyto","text":"list following components: supercell_object: list containing object returned SCimplify function. One object per sample. object critical recomputing supercells future. Hence discard . supercell_expression_matrix:  data.table object contains marker expression supercell. marker expressions computed calculating mean marker expressions across cells within individual supercell. supercell_cell_map: data.table maps cell corresponding supercell. table essential identifying specific supercell cell allocated . proves particularly useful analyses require one expand supercells individual cell level.","code":""},{"path":"https://phipsonlab.github.io/SuperCellCyto/reference/runSuperCellCyto.html","id":"parallel-processing","dir":"Reference","previous_headings":"","what":"Parallel Processing","title":"Run SuperCellCyto on Cytometry Data — runSuperCellCyto","text":"SuperCellCyto can process multiple samples simultaneously parallel. can drastically bring processing time dataset large number samples. enable feature, set BPPARAM parameter either MulticoreParam-class object SnowParam-class object. Importantly, also recommended set number tasks (.e., task parameter either MulticoreParam-class SnowParam-class object) number samples dataset. Furthermore, also recommend setting load_balancing parameter TRUE. ensures optimal distribution samples across multiple cores, particularly important samples varying sizes (number cells).","code":""},{"path":"https://phipsonlab.github.io/SuperCellCyto/reference/runSuperCellCyto.html","id":"cell-id-and-sample-definitions","dir":"Reference","previous_headings":"","what":"Cell ID and Sample Definitions","title":"Run SuperCellCyto on Cytometry Data — runSuperCellCyto","text":"cell_id_colname parameter specifies column dt denotes unique identifier cell. perfectly normal column dataset default. good news trivial create one. can create new vector containing sequence numbers 1 however many cells , append vector new column dataset. Refer vignette . sample_colname parameter specifies column dt denotes sample cell came . default, SuperCellCyto creates supercells sample independent samples. ensures supercell contain cells exactly one sample. constitute sample? purposes, sample represents biological sample experiment. may thinking, possible use different context, say creating supercells population cluster rather biological sample? short answer yes, address vignette.","code":""},{"path":"https://phipsonlab.github.io/SuperCellCyto/reference/runSuperCellCyto.html","id":"computing-pca","dir":"Reference","previous_headings":"","what":"Computing PCA","title":"Run SuperCellCyto on Cytometry Data — runSuperCellCyto","text":"function start computing PCA markers specified markers parameter. default, number PCs calculated set 10. less 10 markers markers parameter, number PCs set however many markers markers parameter. Notably, scaling transformation done markers' expressions prior computing PCs. function use irlba calculate PCA. little gain use cytometry data relatively tiny number features (markers) data.","code":""},{"path":"https://phipsonlab.github.io/SuperCellCyto/reference/runSuperCellCyto.html","id":"setting-supercell-s-resolution","dir":"Reference","previous_headings":"","what":"Setting Supercell's Resolution","title":"Run SuperCellCyto on Cytometry Data — runSuperCellCyto","text":"gam parameter influences number supercells created per sample. lower gam value results , thus generally smaller supercells, vice versa. estimate many supercells get dataset, important understand gam value interpreted context number cells sample. gam=n_cells/n_supercells n_cells denotes number cells n_supercells denotes number supercells created. resolving formula , can roughly estimate many supercells get per sample. example, say 2 samples, sample B. Sample 10,000 cells, sample B 5,000 cells: gam set 10, end 1,000 supercells sample 500 supercells sample B, total 1,500 supercells. gam set 50, end 200 supercells sample 100 supercells sample B, total 300 supercells. Importantly, one expect supercells size. capture /less cells others. trivial estimate many cells captured supercell beforehand.","code":""},{"path":"https://phipsonlab.github.io/SuperCellCyto/reference/runSuperCellCyto.html","id":"computing-knn-network","dir":"Reference","previous_headings":"","what":"Computing kNN network","title":"Run SuperCellCyto on Cytometry Data — runSuperCellCyto","text":"create supercells, kNN (k-Nearest Neighbors) network constructed based k_knn parameter dictates number neighbours (cell) used create network. actual (approximate) kNN network created. walktrap algorithm uses network group cells supercells.","code":""},{"path":"https://phipsonlab.github.io/SuperCellCyto/reference/runSuperCellCyto.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Run SuperCellCyto on Cytometry Data — runSuperCellCyto","text":"Givanna Putri","code":""},{"path":"https://phipsonlab.github.io/SuperCellCyto/reference/runSuperCellCyto.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Run SuperCellCyto on Cytometry Data — runSuperCellCyto","text":"","code":"# Simulate some data set.seed(42) cyto_dat <- simCytoData(nmarkers = 10, ncells = rep(2000,2))  # Setup the columns designating the markers, samples, and cell IDs marker_col <- paste0(\"Marker_\", seq_len(10)) sample_col <- \"Sample\" cell_id_col <- \"Cell_Id\"  supercell_dat <- runSuperCellCyto(     cyto_dat, marker_col,     sample_col, cell_id_col )"},{"path":"https://phipsonlab.github.io/SuperCellCyto/reference/simCytoData.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate cytometry data — simCytoData","title":"Simulate cytometry data — simCytoData","text":"Simulate cytometry data use testing documenting functions require cytometry data. Please run set.seed running function want ensure reproducibility.","code":""},{"path":"https://phipsonlab.github.io/SuperCellCyto/reference/simCytoData.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate cytometry data — simCytoData","text":"","code":"simCytoData(nmarkers = 10, ncells = rep(10000, 2))"},{"path":"https://phipsonlab.github.io/SuperCellCyto/reference/simCytoData.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate cytometry data — simCytoData","text":"nmarkers numeric value specifying number markers simulate. ncells numeric vector specifying number cells simulate per sample. 1 vector element per sample.","code":""},{"path":"https://phipsonlab.github.io/SuperCellCyto/reference/simCytoData.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate cytometry data — simCytoData","text":"data.table object containing simulated cytometry data rows represent cells columns represent markers.","code":""},{"path":"https://phipsonlab.github.io/SuperCellCyto/reference/simCytoData.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Simulate cytometry data — simCytoData","text":"Givanna Putri","code":""},{"path":"https://phipsonlab.github.io/SuperCellCyto/reference/simCytoData.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulate cytometry data — simCytoData","text":"","code":"set.seed(42) cyto_dat <- simCytoData() head(cyto_dat) #>    Marker_1 Marker_2  Marker_3 Marker_4 Marker_5 Marker_6 Marker_7 Marker_8 #>       <num>    <num>     <num>    <num>    <num>    <num>    <num>    <num> #> 1: 18.61597 17.43348  9.213419 18.40881 13.68860 12.77402 15.24751 7.140615 #> 2: 20.23361 19.82792  9.740510 18.16383 13.97108 14.25898 16.05032 5.863752 #> 3: 18.62743 17.76816 11.175358 18.59606 16.08534 13.69734 16.71550 4.750240 #> 4: 20.74051 19.94771  9.797939 18.43590 13.92092 12.64266 15.55953 8.173464 #> 5: 18.65938 18.87830  8.916928 17.83295 15.62066 11.37118 16.08417 6.664707 #> 6: 20.02696 20.76054  9.262685 16.89373 15.92339 13.40002 16.13880 6.862717 #>    Marker_9 Marker_10   Sample Cell_Id #>       <num>     <num>   <char>  <char> #> 1: 14.37555  14.18484 Sample_1  Cell_1 #> 2: 15.58007  15.56981 Sample_1  Cell_2 #> 3: 14.16156  14.92222 Sample_1  Cell_3 #> 4: 14.26637  15.10761 Sample_1  Cell_4 #> 5: 15.12219  15.64231 Sample_1  Cell_5 #> 6: 15.85313  15.52535 Sample_1  Cell_6 dim(cyto_dat) #> [1] 20000    12"},{"path":"https://phipsonlab.github.io/SuperCellCyto/news/index.html","id":"supercellcyto-0991","dir":"Changelog","previous_headings":"","what":"SuperCellCyto 0.99.1","title":"SuperCellCyto 0.99.1","text":"Changed paste sprintf warning messages. Moved example data inst/extdata update vignettes. Add chunk labels vignettes.","code":""},{"path":[]},{"path":"https://phipsonlab.github.io/SuperCellCyto/news/index.html","id":"major-changes-0-99-0","dir":"Changelog","previous_headings":"","what":"Major changes","title":"SuperCellCyto 0.99.0","text":"Added support use median recomputing supercells. Introduced n_pc parameter allow users specify number principal components use PCA step computing supercells. Added utils.R file contain utility functions commonly used.","code":""},{"path":"https://phipsonlab.github.io/SuperCellCyto/news/index.html","id":"minor-changes-0-99-0","dir":"Changelog","previous_headings":"","what":"Minor changes","title":"SuperCellCyto 0.99.0","text":"Cleaned functions added improvements codebase, accordance Bioconductor package development guidelines. Updated vignettes BiocStyle. Added tests.","code":""},{"path":"https://phipsonlab.github.io/SuperCellCyto/news/index.html","id":"supercellcyto-010","dir":"Changelog","previous_headings":"","what":"SuperCellCyto 0.1.0","title":"SuperCellCyto 0.1.0","text":"first release SuperCellCyto. also version SuperCellCyto used preprint:","code":"@article{     putri2023supercellcyto,     title={SuperCellCyto: enabling efficient analysis of large scale cytometry datasets},     author={Putri, Givanna H and Howitt, George and Marsh-Wakefield, Felix and Ashhurst, Thomas Myles and Phipson, Belinda},     journal={bioRxiv},     pages={2023--08},     year={2023},     publisher={Cold Spring Harbor Laboratory} }"}]
