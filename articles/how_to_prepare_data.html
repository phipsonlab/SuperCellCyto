<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>How to Prepare Data for SuperCellCyto • SuperCellCyto</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="How to Prepare Data for SuperCellCyto">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SuperCellCyto</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.99.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/SuperCellCyto.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/how_to_prepare_data.html">How to Prepare Data for SuperCellCyto</a></li>
    <li><a class="dropdown-item" href="../articles/interoperability_with_sce.html">Interoperability with SingleCellExperiment</a></li>
    <li><a class="dropdown-item" href="../articles/interoperability_with_seurat.html">Interoperability with Seurat</a></li>
    <li><a class="dropdown-item" href="../articles/using_supercellcyto_for_stratified_summarising.html">Using SuperCellCyto for Stratified Summarising</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/phipsonlab/SuperCellCyto/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>How to Prepare Data for SuperCellCyto</h1>
                        <h4 data-toc-skip class="author">Givanna
Putri</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/phipsonlab/SuperCellCyto/blob/v0.99.2/vignettes/how_to_prepare_data.Rmd" class="external-link"><code>vignettes/how_to_prepare_data.Rmd</code></a></small>
      <div class="d-none name"><code>how_to_prepare_data.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="performing-quality-control">Performing Quality Control<a class="anchor" aria-label="anchor" href="#performing-quality-control"></a>
</h2>
<p>Prior to creating supercells, it’s crucial to ensure that your
dataset has undergone thorough quality control (QC). We want to retain
only single, live cells and remove any debris, doublets, or dead cells.
Additionally, it is also important to perform compensation to correct
for fluorescence spillover (for Flow data) or to adjust for signal
overlap or spillover between different metal isotopse (for Cytof data).
A well-prepared dataset is key to obtaining reliable supercells from
SuperCellCyto.</p>
<p>Several R packages are available for performing QC on cytometry data.
Notable among these are <a href="https://onlinelibrary.wiley.com/doi/10.1002/cyto.a.24501" class="external-link">PeacoQC</a>,
<a href="https://bioconductor.org/packages/release/bioc/html/CATALYST.html" class="external-link">CATALYST</a>,
and <a href="https://dillonhammill.github.io/CytoExploreR/" class="external-link">CytoExploreR</a>.
These packages are well maintained and are continuously updated. To make
sure that the information we provide do not quickly go out of date, we
highly recommend you to consult the packages’ respective vignettes for
detailed guidance on how to use them to QC your data.</p>
<p>In our manuscript, we used <code>CytoExploreR</code> to QC the
<code>Oetjen_bcell</code> flow cytometry data and <code>CATALYST</code>
to QC the <code>Trussart_cytofruv</code> Cytof data.</p>
<p>The specific scripts used can be found in <a href="https://github.com/phipsonlab/SuperCellCyto-analysis/tree/master/code" class="external-link">Github</a>:</p>
<ol style="list-style-type: decimal">
<li>
<code>b_cell_identification/gate_flow_data.R</code> for
<code>Oetjen_bcell</code> data.</li>
<li>
<code>batch_correction/prepare_data.R</code> for
<code>Trussart_cytofruv</code> data. These scripts were adapted from
those used in the <a href="https://elifesciences.org/articles/59630" class="external-link">CytofRUV
manuscript</a>.</li>
</ol>
<p>For Oetjen_bcell data, we used the following gating strategy post
compensation:</p>
<ol style="list-style-type: decimal">
<li>FSC-H and FSC-A to isolate only the single events. (Also check SSC-H
vs SSC-A).</li>
<li>FSC-A and SSC-A to remove debris.</li>
<li>Live/Dead and SSC-A to isolate live cells.</li>
</ol>
<p>The following is the resulting single live cells manually gated for
the <code>Oetjen_bcell</code> data.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/include_graphics.html" class="external-link">include_graphics</a></span><span class="op">(</span></span>
<span>    <span class="st">"figures/oetjen_bcell_single_live_cells.png"</span>, </span>
<span>    error <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="figures/oetjen_bcell_single_live_cells.png" width="1800"></p>
<p>After completing the QC process, you will have clean data in either
CSV or FCS file formats. The next section will guide you on how to load
these files and proceed with preparing your data for SuperCellCyto.</p>
</div>
<div class="section level2">
<h2 id="preparing-fcscsv-files-for-supercellcyto">Preparing FCS/CSV files for SuperCellCyto<a class="anchor" aria-label="anchor" href="#preparing-fcscsv-files-for-supercellcyto"></a>
</h2>
<p>To use SuperCellCyto, your input data must be formatted as a <a href="https://cran.r-project.org/web/packages/data.table/index.html" class="external-link">data.table</a>
object. Briefly, <code>data.table</code> is an enhanced version of R
native <code>data.frame</code> object. It is a package that offers fast
processing of large <code>data.frame</code>.</p>
<div class="section level3">
<h3 id="cell-id-column">Cell ID column<a class="anchor" aria-label="anchor" href="#cell-id-column"></a>
</h3>
<p>Additionally, each cell in your <code>data.table</code> must also
have a unique identifier. The purpose of this ID is to allow SuperCell
to uniquely identify each cell in the dataset. It will come in super
handy later when/if we need to work out which cells belong to which
supercells, i.e., when we need to expand the supercells out. Generally,
we will need to create this ID ourselves. Most dataset won’t come with
this ID already embedded in.</p>
<p>For this tutorial, we will call the column that denotes the cell ID
<em>cell_id</em>. For your own dataset, you can name this column however
you like, e.g., id, cell_identity, etc. Just make sure you note the
column name as we will need it later to create supercells.</p>
</div>
<div class="section level3">
<h3 id="sample-column">Sample column<a class="anchor" aria-label="anchor" href="#sample-column"></a>
</h3>
<p>Lastly, each cell in the <code>data.table</code> object must also be
associated with a sample. This information must be stored in a column
that we later on pass to the function that creates supercells.
Generally, sample here typically refers to the biological sample the
cell came from.</p>
<p>To create supercells, it is necessary to have this column in our
dataset. This is to ensure that each supercell will only have cells from
exactly one sample. In most cases, it does not make sense to mix cells
from different biological samples in one supercell. Additionally (not as
important), SuperCellCyto can process multiple samples in parallel, and
for it to do that, it needs to know the sample information.</p>
<p>But what if we only have 1 biological sample in our dataset? It does
not matter. We still need to have the sample column in our dataset. The
only difference is that this column will only have 1 unique value.</p>
<p>You can name the column however we like, e.g., Samp, Cell_Samp, etc.
For this tutorial, we will call the column <em>sample</em>. Just make
sure you note the column name as we will need it later to create
supercells.</p>
</div>
<div class="section level3">
<h3 id="preparing-csv-files">Preparing CSV files<a class="anchor" aria-label="anchor" href="#preparing-csv-files"></a>
</h3>
<p>Loading CSV files into a <code>data.table</code> object is
straightforward. We can use the <code>fread</code> function from the
<code>data.table</code> package.</p>
<p>For this example, let’s load two CSV files containing subsampled data
from the <code>Levine_32dim</code> dataset we used in SuperCellCyto
manuscript. Each file represents a sample (H1 and H2), with the sample
name appended to the file name:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">csv_files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span></span>
<span>    <span class="st">"extdata"</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Levine_32dim_H1_sub.csv"</span>, <span class="st">"Levine_32dim_H2_sub.csv"</span><span class="op">)</span>,</span>
<span>    package <span class="op">=</span> <span class="st">"SuperCellCyto"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">samples</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"H1"</span>, <span class="st">"H2"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">samples</span><span class="op">)</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">csv_file</span> <span class="op">&lt;-</span> <span class="va">csv_files</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>    <span class="va">sample</span> <span class="op">&lt;-</span> <span class="va">samples</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span></span>
<span>    <span class="va">dat_a_sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/fread.html" class="external-link">fread</a></span><span class="op">(</span><span class="va">csv_file</span><span class="op">)</span></span>
<span>    <span class="va">dat_a_sample</span><span class="op">$</span><span class="va">sample</span> <span class="op">&lt;-</span> <span class="va">sample</span></span>
<span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">dat_a_sample</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/rbindlist.html" class="external-link">rbindlist</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dat</span><span class="op">[</span>, <span class="va">cell_id</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Cell_"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span>
<span><span class="co">#&gt;      Time Cell_length      DNA1     DNA2   CD45RA      CD133       CD19</span></span>
<span><span class="co">#&gt;     &lt;num&gt;       &lt;int&gt;     &lt;num&gt;    &lt;num&gt;    &lt;num&gt;      &lt;num&gt;      &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1: 307428          27 169.91125 262.3192 2.338830 -0.1533398 -0.2056334</span></span>
<span><span class="co">#&gt; 2:  80712          13  50.91230 181.1320 2.129232  3.3563867 -0.1013980</span></span>
<span><span class="co">#&gt; 3: 284190          53  98.28069 187.2090 4.289627  0.5625419 12.2265682</span></span>
<span><span class="co">#&gt; 4: 324301          25  94.70678 258.6657 6.537235  0.3936968 37.9688492</span></span>
<span><span class="co">#&gt; 5: 253799          45  76.75870 128.8098 4.390123  0.3281800  0.3218679</span></span>
<span><span class="co">#&gt; 6: 313897          50 156.23492 254.4634 4.722823  1.5105748 -0.2037212</span></span>
<span><span class="co">#&gt;          CD22     CD11b         CD4          CD8        CD34        Flt3</span></span>
<span><span class="co">#&gt;         &lt;num&gt;     &lt;num&gt;       &lt;num&gt;        &lt;num&gt;       &lt;num&gt;       &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1: -0.1972007 32.130402  0.78105438 -0.071934469  1.53498471  0.84833205</span></span>
<span><span class="co">#&gt; 2:  3.0564795 14.239288  0.53373063 -0.007943562 -0.09401329 -0.13234507</span></span>
<span><span class="co">#&gt; 3: 10.8176870  1.826709  1.30010796 -0.187664956  2.05419374  2.72891521</span></span>
<span><span class="co">#&gt; 4: 22.7653027  0.176247 -0.04688064 -0.075562298  3.77700782  0.01351853</span></span>
<span><span class="co">#&gt; 5:  2.2320855  1.343770  2.38195324 -0.120859891 -0.01110659  2.28398013</span></span>
<span><span class="co">#&gt; 6:  1.3113755 32.728638  0.33130702 -0.073869787  1.14790535  0.23651542</span></span>
<span><span class="co">#&gt;            CD20     CXCR4    CD235ab      CD45       CD123     CD321</span></span>
<span><span class="co">#&gt;           &lt;num&gt;     &lt;num&gt;      &lt;num&gt;     &lt;num&gt;       &lt;num&gt;     &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1: -0.086762585  3.488938  0.8230118  313.8038  0.30909532 46.484669</span></span>
<span><span class="co">#&gt; 2: -0.042171009  1.364644 -0.1309417  207.2459  1.76594567 22.532978</span></span>
<span><span class="co">#&gt; 3: 15.341629982  9.303430  6.3413548  751.0563  0.05031190 10.463912</span></span>
<span><span class="co">#&gt; 4: 48.562511444 26.948063  0.2169415  588.5150  2.96119761 22.149944</span></span>
<span><span class="co">#&gt; 5:  3.535085201  2.498724 12.1216116 1007.4561 -0.18679842  5.777249</span></span>
<span><span class="co">#&gt; 6: -0.003814452  6.879488  4.4369431  918.5178 -0.03130747 24.542976</span></span>
<span><span class="co">#&gt;           CD14        CD33     CD47      CD11c          CD7      CD15</span></span>
<span><span class="co">#&gt;          &lt;num&gt;       &lt;num&gt;    &lt;num&gt;      &lt;num&gt;        &lt;num&gt;     &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:  0.05072345  2.09802437 20.96871 20.7631855 -0.007966662 0.7279212</span></span>
<span><span class="co">#&gt; 2: -0.19256826  7.35230541 27.49848 15.1339817 -0.087256350 0.7187206</span></span>
<span><span class="co">#&gt; 3:  1.11993504  0.15872155 40.63973  4.6401038 -0.195279136 4.5712810</span></span>
<span><span class="co">#&gt; 4: -0.17467052 -0.18741834  7.64338 -0.1591413  0.604379535 1.1375968</span></span>
<span><span class="co">#&gt; 5: -0.20860019  0.04116142 30.60899  1.8959216 39.631023407 0.8820186</span></span>
<span><span class="co">#&gt; 6:  0.64118510  2.93926096 18.20175 34.3703728 -0.016664671 1.1723862</span></span>
<span><span class="co">#&gt;           CD16      CD44      CD38        CD13         CD3       CD61</span></span>
<span><span class="co">#&gt;          &lt;num&gt;     &lt;num&gt;     &lt;num&gt;       &lt;num&gt;       &lt;num&gt;      &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1: -0.03067662  95.71002  5.112477  5.10564327   0.5827813 -0.1684093</span></span>
<span><span class="co">#&gt; 2:  0.41139653 185.51929  7.478415  0.35808861   1.8861074  1.9233229</span></span>
<span><span class="co">#&gt; 3: -0.10192144  98.09428 43.535297  2.83275175   0.1868679  2.1032026</span></span>
<span><span class="co">#&gt; 4:  1.02131248  45.03027  3.396393 -0.09499715   0.8835158  5.2639704</span></span>
<span><span class="co">#&gt; 5:  0.28814790  81.63257  8.634666  0.80971009 728.0478516  1.9550949</span></span>
<span><span class="co">#&gt; 6:  2.46474814 250.00719 17.964558  0.38511425   1.4373373  9.9041309</span></span>
<span><span class="co">#&gt;          CD117     CD49d      HLA-DR       CD64        CD41 Viability</span></span>
<span><span class="co">#&gt;          &lt;num&gt;     &lt;num&gt;       &lt;num&gt;      &lt;num&gt;       &lt;num&gt;     &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1: -0.02967962  6.557199 112.4675446  6.9157209  0.08380865  1.726863</span></span>
<span><span class="co">#&gt; 2: -0.14122920  1.088500  12.2067947 30.7242870  7.75372791  3.712019</span></span>
<span><span class="co">#&gt; 3:  0.01776284 12.400333 174.9526672  0.4361930  1.83412540 13.274319</span></span>
<span><span class="co">#&gt; 4:  0.19813232  2.382564   3.4147604  0.9252884 -0.06184266  1.482011</span></span>
<span><span class="co">#&gt; 5:  3.34092522  1.395274   0.3110902  0.1227915  0.27702999  3.165646</span></span>
<span><span class="co">#&gt; 6:  0.46414420 14.136827  26.3479862 20.1809521 10.70872402 23.840090</span></span>
<span><span class="co">#&gt;    file_number event_number sample cell_id</span></span>
<span><span class="co">#&gt;          &lt;int&gt;        &lt;int&gt; &lt;char&gt;  &lt;char&gt;</span></span>
<span><span class="co">#&gt; 1:          94       257088     H1  Cell_1</span></span>
<span><span class="co">#&gt; 2:          94        80655     H1  Cell_2</span></span>
<span><span class="co">#&gt; 3:          94       241699     H1  Cell_3</span></span>
<span><span class="co">#&gt; 4:          94       268117     H1  Cell_4</span></span>
<span><span class="co">#&gt; 5:          94       221804     H1  Cell_5</span></span>
<span><span class="co">#&gt; 6:          94       261282     H1  Cell_6</span></span></code></pre></div>
<p>Let’s break down what we have done.</p>
<p>We specify the location of the csv files in <code>csv_files</code>
vector and their corresponding sample names in <code>samples</code>
vector. <code>Levine_32dim_H1_sub.csv</code> belongs to sample H1 while
<code>Levine_32dim_H2_sub.csv</code> belongs to sample H2.</p>
<p>We use <code>lapply</code> to simultaneously iterate over each
element in the <code>csv_files</code> and <code>samples</code> vector.
For each csv file and the corresponding sample, we read the csv file
into the variable <code>dat_a_sample</code> using <code>fread</code>
function. We then assign the sample id in a new column called
<code>sample</code>. As a result, we get a list <code>dat</code>
containing 2 <code>data.table</code> objects, 1 object per csv file.</p>
<p>We use <code>rbindlist</code> function from the
<code>data.table</code> package to merge list into one
<code>data.table</code> object.</p>
<p>We create a new column <code>cell_id</code> which gives each cell a
unique id such as <code>Cell_1</code>, <code>Cell_2</code>, etc.</p>
</div>
<div class="section level3">
<h3 id="preparing-fcs-files">Preparing FCS files<a class="anchor" aria-label="anchor" href="#preparing-fcs-files"></a>
</h3>
<p>FCS files, commonly used in cytometry, require specific handling. You
can read in FCS files using the <code>flowCore</code> package available
from Bioconductor and convert it to a <code>data.table</code>
object.</p>
<p>Let’s load two small FCS files for the Anti-PD1 data from <a href="http://flowrepository.org/public_experiment_representations/1124" class="external-link">FlowRepository</a>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">flowCore</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">fs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/flowCore/man/read.flowSet.html" class="external-link">read.flowSet</a></span><span class="op">(</span></span>
<span>    path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span></span>
<span>        <span class="st">"extdata"</span>,</span>
<span>        package <span class="op">=</span> <span class="st">"SuperCellCyto"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    pattern <span class="op">=</span> <span class="st">"\\.fcs$"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">dat_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">fs</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/as.data.table.html" class="external-link">as.data.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/Biobase/man/exprs.html" class="external-link">exprs</a></span><span class="op">(</span><span class="va">fs</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>    <span class="co"># concatenate channel and marker name as column names</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/flowCore/man/markernames.html" class="external-link">markernames</a></span><span class="op">(</span><span class="va">fs</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span>    <span class="co"># add a column showing the filename</span></span>
<span>    <span class="va">df</span><span class="op">$</span><span class="va">file_name</span> <span class="op">&lt;-</span> <span class="fu">sampleNames</span><span class="op">(</span><span class="va">fs</span><span class="op">)</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># collate all the files into one</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/rbindlist.html" class="external-link">rbindlist</a></span><span class="op">(</span><span class="va">dat_list</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dat</span></span>
<span><span class="co">#&gt;      209Bi_CD11b 162Dy_CD11c  163Dy_CD7 166Er_CD209  167Er_CD38 151Eu_CD123</span></span>
<span><span class="co">#&gt;            &lt;num&gt;       &lt;num&gt;      &lt;num&gt;       &lt;num&gt;       &lt;num&gt;       &lt;num&gt;</span></span>
<span><span class="co">#&gt;   1:    2.596444    0.000000  24.233248   2.4271879   0.2497845  0.01359761</span></span>
<span><span class="co">#&gt;   2:   20.172476   29.508638 253.930161   2.0283859  63.4845619  0.00000000</span></span>
<span><span class="co">#&gt;   3:  224.771057  377.262421  20.755060   5.5264821 111.7728882 10.33144855</span></span>
<span><span class="co">#&gt;   4:  711.252808  192.961227  16.039482   2.7453365  13.4806919  1.71946943</span></span>
<span><span class="co">#&gt;   5:  435.131073  203.836838   5.983910   0.0000000   4.2271118  1.08193946</span></span>
<span><span class="co">#&gt;  ---                                                                       </span></span>
<span><span class="co">#&gt; 569:  337.737152  160.982407   1.724550   0.8164008  10.8179998  1.87148142</span></span>
<span><span class="co">#&gt; 570:   48.965187    3.454711  55.719162   0.7539494  20.6741104  0.00000000</span></span>
<span><span class="co">#&gt; 571:  326.666168   58.792435   4.358847   0.0000000   8.6697922  0.00000000</span></span>
<span><span class="co">#&gt; 572:    7.255682    0.000000   3.552515   0.0000000   2.9367595  0.43651727</span></span>
<span><span class="co">#&gt; 573:  349.350769   31.072611   1.050743   0.0000000   5.4545450  5.87748337</span></span>
<span><span class="co">#&gt;      153Eu_CD62L 152Gd_CD66b 154Gd_ICAM-1 155Gd_CD1c  156Gd_CD86 160Gd_CD14</span></span>
<span><span class="co">#&gt;            &lt;num&gt;       &lt;num&gt;        &lt;num&gt;      &lt;num&gt;       &lt;num&gt;      &lt;num&gt;</span></span>
<span><span class="co">#&gt;   1:  276.736237   0.0000000    6.3661394 0.72167069   0.0000000   0.000000</span></span>
<span><span class="co">#&gt;   2:    7.522890   0.0000000   16.6949806 0.00000000   0.9723848   2.370285</span></span>
<span><span class="co">#&gt;   3:    2.523962   0.0000000  480.9555969 2.87207913 109.6869812  41.803619</span></span>
<span><span class="co">#&gt;   4:    1.439798   0.0000000  125.3002014 0.00000000   5.1308088  19.226034</span></span>
<span><span class="co">#&gt;   5:    3.030660   0.0000000   54.1368217 0.03324713  23.3382854  14.204736</span></span>
<span><span class="co">#&gt;  ---                                                                       </span></span>
<span><span class="co">#&gt; 569:    0.000000   0.0000000  158.1088257 2.28826094  15.2002096   5.657256</span></span>
<span><span class="co">#&gt; 570:    3.414483   0.0000000    0.9569107 2.11766744   0.7849152   4.082072</span></span>
<span><span class="co">#&gt; 571:    0.000000   0.0000000    1.1182016 0.00000000   0.0000000   0.000000</span></span>
<span><span class="co">#&gt; 572:    2.556602   0.6154923    0.0000000 0.00000000   0.0000000   0.000000</span></span>
<span><span class="co">#&gt; 573:    3.925082   0.0000000   43.5083618 0.00000000   4.2216253   8.216695</span></span>
<span><span class="co">#&gt;       165Ho_CD16 191Ir_DNA1 193Ir_DNA2 175Lu_PD-L1 142Nd_CD19 146Nd_CD64</span></span>
<span><span class="co">#&gt;            &lt;num&gt;      &lt;num&gt;      &lt;num&gt;       &lt;num&gt;      &lt;num&gt;      &lt;num&gt;</span></span>
<span><span class="co">#&gt;   1:   0.0000000   40.33384   76.70573   0.0000000 0.00000000   5.452389</span></span>
<span><span class="co">#&gt;   2: 126.4256592   55.11267  150.46278   3.4527724 0.00000000   1.922374</span></span>
<span><span class="co">#&gt;   3:   2.0556698   91.42932  161.59381   8.3969393 0.00000000  12.956987</span></span>
<span><span class="co">#&gt;   4:   0.0000000   75.32122  160.41399   0.1078656 0.00000000  12.841355</span></span>
<span><span class="co">#&gt;   5:   0.5523136   79.88800  142.12471   0.6882498 0.00000000  19.308508</span></span>
<span><span class="co">#&gt;  ---                                                                    </span></span>
<span><span class="co">#&gt; 569:   0.0000000   65.31769  148.84435   0.1064020 0.00000000  22.941177</span></span>
<span><span class="co">#&gt; 570:  51.3577194   65.16866  129.46790   3.5496852 0.36609724   2.852356</span></span>
<span><span class="co">#&gt; 571:   0.9855582   92.97505  151.65977   0.0000000 0.03485066   6.290884</span></span>
<span><span class="co">#&gt; 572:   0.0000000   65.07745  111.99138   0.5479890 0.63119560   0.000000</span></span>
<span><span class="co">#&gt; 573:   0.0000000  114.67633  191.50166   0.0000000 0.00000000  12.638340</span></span>
<span><span class="co">#&gt;          195Pt     196Pt 198Pt_Dead 147Sm_CD303 148Sm_CD34 149Sm_CD141</span></span>
<span><span class="co">#&gt;          &lt;num&gt;     &lt;num&gt;      &lt;num&gt;       &lt;num&gt;      &lt;num&gt;       &lt;num&gt;</span></span>
<span><span class="co">#&gt;   1: 0.0000000 0.0000000  15.199163   0.0000000  1.2188276    2.482402</span></span>
<span><span class="co">#&gt;   2: 2.6318610 0.0000000  32.325874   0.0000000  0.2467884    0.000000</span></span>
<span><span class="co">#&gt;   3: 0.2854315 0.3602256  10.119688   0.7021694  7.2453775   17.055792</span></span>
<span><span class="co">#&gt;   4: 1.7483448 1.6977243   2.457203   0.0000000  1.1050161    6.811901</span></span>
<span><span class="co">#&gt;   5: 0.0000000 2.7839208  13.680239   0.8908378  0.0000000   18.400421</span></span>
<span><span class="co">#&gt;  ---                                                                  </span></span>
<span><span class="co">#&gt; 569: 0.0000000 0.0000000  16.751446   2.6801469  0.6307272    2.710867</span></span>
<span><span class="co">#&gt; 570: 0.3765990 0.0000000  20.695446   0.0000000  3.0734873    1.968072</span></span>
<span><span class="co">#&gt; 571: 0.1897834 0.0000000  16.076082   0.9444249  0.4878764    6.945232</span></span>
<span><span class="co">#&gt; 572: 0.0000000 0.0000000  23.279974   0.0000000  0.0000000    0.000000</span></span>
<span><span class="co">#&gt; 573: 0.0000000 4.0132923  12.463143   0.8065992  1.6200637    4.190233</span></span>
<span><span class="co">#&gt;      150Sm_CD61  169Tm_CD33  89Y_CD45  170Yb_CD3  173Yb_CD56 174Yb_HLA-DR</span></span>
<span><span class="co">#&gt;           &lt;num&gt;       &lt;num&gt;     &lt;num&gt;      &lt;num&gt;       &lt;num&gt;        &lt;num&gt;</span></span>
<span><span class="co">#&gt;   1:  65.015724   1.1326860  37.52760  9.0316811  0.00000000     6.807954</span></span>
<span><span class="co">#&gt;   2:  25.455738   0.1979908 225.64279  0.9135754  8.38446426     5.601559</span></span>
<span><span class="co">#&gt;   3:  75.056625 134.7255249 458.79022 12.2988071 10.31508160   403.328308</span></span>
<span><span class="co">#&gt;   4:  21.287003  58.7627487 387.78836  1.1870043  0.00000000    88.822212</span></span>
<span><span class="co">#&gt;   5:  26.795689  35.0521393 107.94828  0.3782265  5.60699320   104.159081</span></span>
<span><span class="co">#&gt;  ---                                                                     </span></span>
<span><span class="co">#&gt; 569:  36.163387  22.8519592 227.01973  2.7277973  0.02519703   188.378601</span></span>
<span><span class="co">#&gt; 570:  37.537052   3.3848262  48.12588  4.6816015  2.54012346    10.622149</span></span>
<span><span class="co">#&gt; 571:  16.739002  10.3474064  60.64515  0.6677586  0.00000000    15.465885</span></span>
<span><span class="co">#&gt; 572:  15.469506   0.0000000  11.47586  8.9600000  0.00000000     0.000000</span></span>
<span><span class="co">#&gt; 573:   8.587144  18.8689251  52.50787  0.6892268  1.88265443    13.542062</span></span>
<span><span class="co">#&gt;                                file_name</span></span>
<span><span class="co">#&gt;                                   &lt;char&gt;</span></span>
<span><span class="co">#&gt;   1: Data23_Panel3_base_NR4_Patient9.fcs</span></span>
<span><span class="co">#&gt;   2: Data23_Panel3_base_NR4_Patient9.fcs</span></span>
<span><span class="co">#&gt;   3: Data23_Panel3_base_NR4_Patient9.fcs</span></span>
<span><span class="co">#&gt;   4: Data23_Panel3_base_NR4_Patient9.fcs</span></span>
<span><span class="co">#&gt;   5: Data23_Panel3_base_NR4_Patient9.fcs</span></span>
<span><span class="co">#&gt;  ---                                    </span></span>
<span><span class="co">#&gt; 569: Data23_Panel3_base_R5_Patient15.fcs</span></span>
<span><span class="co">#&gt; 570: Data23_Panel3_base_R5_Patient15.fcs</span></span>
<span><span class="co">#&gt; 571: Data23_Panel3_base_R5_Patient15.fcs</span></span>
<span><span class="co">#&gt; 572: Data23_Panel3_base_R5_Patient15.fcs</span></span>
<span><span class="co">#&gt; 573: Data23_Panel3_base_R5_Patient15.fcs</span></span></code></pre></div>
<p>The code above used <code>flowCore</code>’s <code>read.flowSet</code>
function to first read FCS files into a <code>flowSet</code> object.</p>
<p><code>lapply</code> and <code>rbindlist</code> is then used to
convert it to one <code>data.table</code> object containing data from
all FCS files.</p>
<p>The FCS files belong to two different patients, patient 9 and 15. We
shall use that as the sample ID. To make sure that we correctly map the
filenames to the patients, we will first create a new
<code>data.table</code> object containing the mapping of FileName and
the sample name, and then using <code>merge.data.table</code> to add
them into our <code>data.table</code> object.</p>
<p>We will also to create a new column <code>cell_id</code> which gives
each cell a unique id such as <code>Cell_1</code>, <code>Cell_2</code>,
etc.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sample_info</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></span><span class="op">(</span></span>
<span>    sample <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"patient9"</span>, <span class="st">"patient15"</span><span class="op">)</span>,</span>
<span>    file_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>        <span class="st">"Data23_Panel3_base_NR4_Patient9.fcs"</span>,</span>
<span>        <span class="st">"Data23_Panel3_base_R5_Patient15.fcs"</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/merge.html" class="external-link">merge.data.table</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">dat</span>,</span>
<span>    y <span class="op">=</span> <span class="va">sample_info</span>,</span>
<span>    by <span class="op">=</span> <span class="st">"file_name"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">dat</span><span class="op">[</span>, <span class="va">cell_id</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Cell_"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<p>With CSV and FCS files loaded as data.table objects, the next step is
to transform the data appropriately for SuperCellCyto.</p>
</div>
</div>
<div class="section level2">
<h2 id="data-transformation">Data Transformation<a class="anchor" aria-label="anchor" href="#data-transformation"></a>
</h2>
<p>Before using SuperCellCyto, it’s essential to apply appropriate data
transformations.</p>
<p>A common method for data transformation in cytometry is the arcsinh
transformation, an <a href="https://mathworld.wolfram.com/InverseHyperbolicSine.html" class="external-link">inverse
hyperbolic arcsinh transformation</a>. The transformation requires
specifying a cofactor, which affects the representation of the low-end
data. Typically, a cofactor of 5 is used for Cytof data and 150 for Flow
data. This vignette will focus on the transformation process rather than
cofactor selection.</p>
<p>We’ll use the <code>Levine_32dim</code> dataset loaded earlier from
CSV files.</p>
<p>First, we need to select the markers to be transformed. Usually, all
markers should be transformed for SuperCellCyto. However, you can choose
to exclude specific markers if needed:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">markers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"209Bi_CD11b"</span>, <span class="st">"162Dy_CD11c"</span>, <span class="st">"163Dy_CD7"</span>, <span class="st">"166Er_CD209"</span>, <span class="st">"167Er_CD38"</span>,</span>
<span>    <span class="st">"151Eu_CD123"</span>, <span class="st">"153Eu_CD62L"</span>, <span class="st">"152Gd_CD66b"</span>, <span class="st">"154Gd_ICAM-1"</span>, <span class="st">"155Gd_CD1c"</span>,</span>
<span>    <span class="st">"156Gd_CD86"</span>, <span class="st">"160Gd_CD14"</span>, <span class="st">"165Ho_CD16"</span>, <span class="st">"191Ir_DNA1"</span>, <span class="st">"193Ir_DNA2"</span>,</span>
<span>    <span class="st">"175Lu_PD-L1"</span>, <span class="st">"142Nd_CD19"</span>, <span class="st">"146Nd_CD64"</span>, <span class="st">"195Pt"</span>, <span class="st">"196Pt"</span>,</span>
<span>    <span class="st">"198Pt_Dead"</span>, <span class="st">"147Sm_CD303"</span>, <span class="st">"148Sm_CD34"</span>, <span class="st">"149Sm_CD141"</span>, <span class="st">"150Sm_CD61"</span>,</span>
<span>    <span class="st">"169Tm_CD33"</span>, <span class="st">"89Y_CD45"</span>, <span class="st">"170Yb_CD3"</span>, <span class="st">"173Yb_CD56"</span>, <span class="st">"174Yb_HLA-DR"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>For transformation, we’ll use a cofactor of 5 and apply the arcsinh
transformation.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">new_cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">markers</span>, <span class="st">"_asinh"</span><span class="op">)</span></span>
<span><span class="va">cf</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span><span class="va">dat</span><span class="op">[</span>, <span class="op">(</span><span class="va">new_cols</span><span class="op">)</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">.SD</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Hyperbolic.html" class="external-link">asinh</a></span><span class="op">(</span><span class="va">x</span> <span class="op">/</span> <span class="va">cf</span><span class="op">)</span><span class="op">)</span>, .SDcols <span class="op">=</span> <span class="va">markers</span><span class="op">]</span></span></code></pre></div>
<p>After transformation, new columns with “_asinh” appended indicate the
transformed markers.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span>
<span><span class="co">#&gt; Key: &lt;file_name&gt;</span></span>
<span><span class="co">#&gt;                              file_name 209Bi_CD11b 162Dy_CD11c  163Dy_CD7</span></span>
<span><span class="co">#&gt;                                 &lt;char&gt;       &lt;num&gt;       &lt;num&gt;      &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1: Data23_Panel3_base_NR4_Patient9.fcs    2.596444     0.00000  24.233248</span></span>
<span><span class="co">#&gt; 2: Data23_Panel3_base_NR4_Patient9.fcs   20.172476    29.50864 253.930161</span></span>
<span><span class="co">#&gt; 3: Data23_Panel3_base_NR4_Patient9.fcs  224.771057   377.26242  20.755060</span></span>
<span><span class="co">#&gt; 4: Data23_Panel3_base_NR4_Patient9.fcs  711.252808   192.96123  16.039482</span></span>
<span><span class="co">#&gt; 5: Data23_Panel3_base_NR4_Patient9.fcs  435.131073   203.83684   5.983910</span></span>
<span><span class="co">#&gt; 6: Data23_Panel3_base_NR4_Patient9.fcs  182.881317   244.65285   5.262897</span></span>
<span><span class="co">#&gt;    166Er_CD209  167Er_CD38 151Eu_CD123 153Eu_CD62L 152Gd_CD66b 154Gd_ICAM-1</span></span>
<span><span class="co">#&gt;          &lt;num&gt;       &lt;num&gt;       &lt;num&gt;       &lt;num&gt;       &lt;num&gt;        &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:    2.427188   0.2497845  0.01359761  276.736237           0     6.366139</span></span>
<span><span class="co">#&gt; 2:    2.028386  63.4845619  0.00000000    7.522890           0    16.694981</span></span>
<span><span class="co">#&gt; 3:    5.526482 111.7728882 10.33144855    2.523962           0   480.955597</span></span>
<span><span class="co">#&gt; 4:    2.745337  13.4806919  1.71946943    1.439798           0   125.300201</span></span>
<span><span class="co">#&gt; 5:    0.000000   4.2271118  1.08193946    3.030660           0    54.136822</span></span>
<span><span class="co">#&gt; 6:    1.548412  34.4840889  1.36238360    0.000000           0    13.646034</span></span>
<span><span class="co">#&gt;    155Gd_CD1c  156Gd_CD86 160Gd_CD14  165Ho_CD16 191Ir_DNA1 193Ir_DNA2</span></span>
<span><span class="co">#&gt;         &lt;num&gt;       &lt;num&gt;      &lt;num&gt;       &lt;num&gt;      &lt;num&gt;      &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1: 0.72167069   0.0000000   0.000000   0.0000000   40.33384   76.70573</span></span>
<span><span class="co">#&gt; 2: 0.00000000   0.9723848   2.370285 126.4256592   55.11267  150.46278</span></span>
<span><span class="co">#&gt; 3: 2.87207913 109.6869812  41.803619   2.0556698   91.42932  161.59381</span></span>
<span><span class="co">#&gt; 4: 0.00000000   5.1308088  19.226034   0.0000000   75.32122  160.41399</span></span>
<span><span class="co">#&gt; 5: 0.03324713  23.3382854  14.204736   0.5523136   79.88800  142.12471</span></span>
<span><span class="co">#&gt; 6: 4.62103748  11.6817465   2.560833   0.0000000   56.35513   93.84315</span></span>
<span><span class="co">#&gt;    175Lu_PD-L1 142Nd_CD19 146Nd_CD64     195Pt     196Pt 198Pt_Dead 147Sm_CD303</span></span>
<span><span class="co">#&gt;          &lt;num&gt;      &lt;num&gt;      &lt;num&gt;     &lt;num&gt;     &lt;num&gt;      &lt;num&gt;       &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:   0.0000000          0   5.452389 0.0000000 0.0000000  15.199163   0.0000000</span></span>
<span><span class="co">#&gt; 2:   3.4527724          0   1.922374 2.6318610 0.0000000  32.325874   0.0000000</span></span>
<span><span class="co">#&gt; 3:   8.3969393          0  12.956987 0.2854315 0.3602256  10.119688   0.7021694</span></span>
<span><span class="co">#&gt; 4:   0.1078656          0  12.841355 1.7483448 1.6977243   2.457203   0.0000000</span></span>
<span><span class="co">#&gt; 5:   0.6882498          0  19.308508 0.0000000 2.7839208  13.680239   0.8908378</span></span>
<span><span class="co">#&gt; 6:   5.6380033          0   8.388703 0.0000000 0.0000000   3.202339   0.7597103</span></span>
<span><span class="co">#&gt;    148Sm_CD34 149Sm_CD141 150Sm_CD61  169Tm_CD33 89Y_CD45  170Yb_CD3 173Yb_CD56</span></span>
<span><span class="co">#&gt;         &lt;num&gt;       &lt;num&gt;      &lt;num&gt;       &lt;num&gt;    &lt;num&gt;      &lt;num&gt;      &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:  1.2188276    2.482402   65.01572   1.1326860  37.5276  9.0316811   0.000000</span></span>
<span><span class="co">#&gt; 2:  0.2467884    0.000000   25.45574   0.1979908 225.6428  0.9135754   8.384464</span></span>
<span><span class="co">#&gt; 3:  7.2453775   17.055792   75.05663 134.7255249 458.7902 12.2988071  10.315082</span></span>
<span><span class="co">#&gt; 4:  1.1050161    6.811901   21.28700  58.7627487 387.7884  1.1870043   0.000000</span></span>
<span><span class="co">#&gt; 5:  0.0000000   18.400421   26.79569  35.0521393 107.9483  0.3782265   5.606993</span></span>
<span><span class="co">#&gt; 6:  4.0056577    2.323631   12.82973  55.7610817 444.4799  0.6113114   1.556887</span></span>
<span><span class="co">#&gt;    174Yb_HLA-DR   sample cell_id 209Bi_CD11b_asinh 162Dy_CD11c_asinh</span></span>
<span><span class="co">#&gt;           &lt;num&gt;   &lt;char&gt;  &lt;char&gt;             &lt;num&gt;             &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:     6.807954 patient9  Cell_1         0.4983974          0.000000</span></span>
<span><span class="co">#&gt; 2:     5.601559 patient9  Cell_2         2.1030451          2.475494</span></span>
<span><span class="co">#&gt; 3:   403.328308 patient9  Cell_3         4.4989153          5.016694</span></span>
<span><span class="co">#&gt; 4:    88.822212 patient9  Cell_4         5.6507496          4.346366</span></span>
<span><span class="co">#&gt; 5:   104.159081 patient9  Cell_5         5.1593896          4.401180</span></span>
<span><span class="co">#&gt; 6:   145.182190 patient9  Cell_6         4.2927335          4.583654</span></span>
<span><span class="co">#&gt;    163Dy_CD7_asinh 166Er_CD209_asinh 167Er_CD38_asinh 151Eu_CD123_asinh</span></span>
<span><span class="co">#&gt;              &lt;num&gt;             &lt;num&gt;            &lt;num&gt;             &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:       2.2819117         0.4681490       0.04993614       0.002719519</span></span>
<span><span class="co">#&gt; 2:       4.6208655         0.3953013       3.23605319       0.000000000</span></span>
<span><span class="co">#&gt; 3:       2.1307022         0.9539050       3.80067819       1.472894089</span></span>
<span><span class="co">#&gt; 4:       1.8822162         0.5246630       1.71770981       0.337452783</span></span>
<span><span class="co">#&gt; 5:       1.0139113         0.0000000       0.76774561       0.214733831</span></span>
<span><span class="co">#&gt; 6:       0.9180684         0.3049346       2.62942218       0.269213018</span></span>
<span><span class="co">#&gt;    153Eu_CD62L_asinh 152Gd_CD66b_asinh 154Gd_ICAM-1_asinh 155Gd_CD1c_asinh</span></span>
<span><span class="co">#&gt;                &lt;num&gt;             &lt;num&gt;              &lt;num&gt;            &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:         4.7068557                 0           1.062022      0.143837642</span></span>
<span><span class="co">#&gt; 2:         1.1972999                 0           1.920522      0.000000000</span></span>
<span><span class="co">#&gt; 3:         0.4854943                 0           5.259511      0.546763229</span></span>
<span><span class="co">#&gt; 4:         0.2841215                 0           3.914820      0.000000000</span></span>
<span><span class="co">#&gt; 5:         0.5740759                 0           3.077350      0.006649377</span></span>
<span><span class="co">#&gt; 6:         0.0000000                 0           1.729148      0.826752274</span></span>
<span><span class="co">#&gt;    156Gd_CD86_asinh 160Gd_CD14_asinh 165Ho_CD16_asinh 191Ir_DNA1_asinh</span></span>
<span><span class="co">#&gt;               &lt;num&gt;            &lt;num&gt;            &lt;num&gt;            &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:        0.0000000        0.0000000        0.0000000         2.784720</span></span>
<span><span class="co">#&gt; 2:        0.1932715        0.4578881        3.9237545         3.095140</span></span>
<span><span class="co">#&gt; 3:        3.7818590        2.8202496        0.4003530         3.600022</span></span>
<span><span class="co">#&gt; 4:        0.8997523        2.0564695        0.0000000         3.406571</span></span>
<span><span class="co">#&gt; 5:        2.2450865        1.7669123        0.1102393         3.465313</span></span>
<span><span class="co">#&gt; 6:        1.5846764        0.4920673        0.0000000         3.117345</span></span>
<span><span class="co">#&gt;    193Ir_DNA2_asinh 175Lu_PD-L1_asinh 142Nd_CD19_asinh 146Nd_CD64_asinh</span></span>
<span><span class="co">#&gt;               &lt;num&gt;             &lt;num&gt;            &lt;num&gt;            &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:         3.424746        0.00000000                0        0.9439264</span></span>
<span><span class="co">#&gt; 2:         4.097701        0.64491132                0        0.3755822</span></span>
<span><span class="co">#&gt; 3:         4.169034        1.29032235                0        1.6806506</span></span>
<span><span class="co">#&gt; 4:         4.161710        0.02157144                0        1.6722922</span></span>
<span><span class="co">#&gt; 5:         4.040723        0.13721893                0        2.0606128</span></span>
<span><span class="co">#&gt; 6:         3.626043        0.96878631                0        1.2894793</span></span>
<span><span class="co">#&gt;    195Pt_asinh 196Pt_asinh 198Pt_Dead_asinh 147Sm_CD303_asinh 148Sm_CD34_asinh</span></span>
<span><span class="co">#&gt;          &lt;num&gt;       &lt;num&gt;            &lt;num&gt;             &lt;num&gt;            &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:  0.00000000  0.00000000        1.8309680         0.0000000       0.24141372</span></span>
<span><span class="co">#&gt; 2:  0.50467458  0.00000000        2.5655054         0.0000000       0.04933766</span></span>
<span><span class="co">#&gt; 3:  0.05705535  0.07198295        1.4542897         0.1399763       1.16617935</span></span>
<span><span class="co">#&gt; 4:  0.34290908  0.33333742        0.4735430         0.0000000       0.21924260</span></span>
<span><span class="co">#&gt; 5:  0.00000000  0.53141631        1.7314988         0.1772382       0.00000000</span></span>
<span><span class="co">#&gt; 6:  0.00000000  0.00000000        0.6032147         0.1513634       0.73355159</span></span>
<span><span class="co">#&gt;    149Sm_CD141_asinh 150Sm_CD61_asinh 169Tm_CD33_asinh 89Y_CD45_asinh</span></span>
<span><span class="co">#&gt;                &lt;num&gt;            &lt;num&gt;            &lt;num&gt;          &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:         0.4780616         3.259814       0.22464301       2.713195</span></span>
<span><span class="co">#&gt; 2:         0.0000000         2.330159       0.03958781       4.502785</span></span>
<span><span class="co">#&gt; 3:         1.9410230         3.403060       3.98729298       5.212332</span></span>
<span><span class="co">#&gt; 4:         1.1159197         2.155322       3.15902249       5.044211</span></span>
<span><span class="co">#&gt; 5:         2.0140514         2.380543       2.64559441       3.765897</span></span>
<span><span class="co">#&gt; 6:         0.4494416         1.671448       3.10678950       5.180646</span></span>
<span><span class="co">#&gt;    170Yb_CD3_asinh 173Yb_CD56_asinh 174Yb_HLA-DR_asinh</span></span>
<span><span class="co">#&gt;              &lt;num&gt;            &lt;num&gt;              &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:      1.35351374        0.0000000          1.1154525</span></span>
<span><span class="co">#&gt; 2:      0.18171341        1.2890452          0.9639413</span></span>
<span><span class="co">#&gt; 3:      1.63218235        1.4714672          5.0834986</span></span>
<span><span class="co">#&gt; 4:      0.23522564        0.0000000          3.5711373</span></span>
<span><span class="co">#&gt; 5:      0.07557334        0.9646649          3.7302042</span></span>
<span><span class="co">#&gt; 6:      0.12195971        0.3065534          4.0619951</span></span></code></pre></div>
<p>With your data now transformed, you’re ready to create supercells
using SuperCellCyto. Please refer to <a href="SuperCellCyto.html">How to
create supercells</a> vignette for detailed instructions.</p>
</div>
<div class="section level2">
<h2 id="session-information">Session information<a class="anchor" aria-label="anchor" href="#session-information"></a>
</h2>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.5.1 (2025-06-13)</span></span>
<span><span class="co">#&gt; Platform: x86_64-pc-linux-gnu</span></span>
<span><span class="co">#&gt; Running under: Ubuntu 24.04.3 LTS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">#&gt; LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">#&gt;  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">#&gt;  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">#&gt; [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: UTC</span></span>
<span><span class="co">#&gt; tzcode source: system (glibc)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt; [1] flowCore_2.20.0   data.table_1.17.8 BiocStyle_2.36.0 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] cli_3.6.5           knitr_1.50          rlang_1.1.6        </span></span>
<span><span class="co">#&gt;  [4] xfun_0.53           png_0.1-8           generics_0.1.4     </span></span>
<span><span class="co">#&gt;  [7] textshaping_1.0.3   jsonlite_2.0.0      RProtoBufLib_2.20.0</span></span>
<span><span class="co">#&gt; [10] S4Vectors_0.46.0    htmltools_0.5.8.1   stats4_4.5.1       </span></span>
<span><span class="co">#&gt; [13] ragg_1.5.0          sass_0.4.10         Biobase_2.68.0     </span></span>
<span><span class="co">#&gt; [16] rmarkdown_2.29      evaluate_1.0.5      jquerylib_0.1.4    </span></span>
<span><span class="co">#&gt; [19] fastmap_1.2.0       yaml_2.3.10         lifecycle_1.0.4    </span></span>
<span><span class="co">#&gt; [22] bookdown_0.44       BiocManager_1.30.26 compiler_4.5.1     </span></span>
<span><span class="co">#&gt; [25] fs_1.6.6            htmlwidgets_1.6.4   systemfonts_1.2.3  </span></span>
<span><span class="co">#&gt; [28] digest_0.6.37       R6_2.6.1            cytolib_2.20.0     </span></span>
<span><span class="co">#&gt; [31] bslib_0.9.0         tools_4.5.1         matrixStats_1.5.0  </span></span>
<span><span class="co">#&gt; [34] BiocGenerics_0.54.0 pkgdown_2.1.3       cachem_1.1.0       </span></span>
<span><span class="co">#&gt; [37] desc_1.4.3</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Givanna Putri, George Howitt, Felix Marsh-Wakefield, Thomas Ashhurst, Belinda Phipson.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
